// calculator.js.coffee
(function(){var n;deckorate._regionLookup=function(n,o){var r;if(r=(deckorate.region||{})[n])return r[o]},deckorate._addFormulaFunctions=function(n){var o,r,t,e,u,c;for(u=[],o=0,t=(e=[deckorate.calculator,formulajs]).length;o<t;o++)c=e[o],u.push(function(){var o,t,e,u;for(u=[],o=0,t=(e=Object.keys(c)).length;o<t;o++)r=e[o],u.push(n[r]=c[r]);return u}());return u},deckorate.calculator={iloRegion:function(n){return deckorate._regionLookup(n,"ilo_region")},country:function(n){return deckorate._regionLookup(n,"country")},isKnown:function(n){return"Unknown"!==n},numKnown:function(n){return n.filter(isKnown).length},anyKnown:function(n){return n.find(isKnown)}},n=function(){return deckorate._addFormulaFunctions(this)}}).call(this);
// variables.js.coffee
(function(){$.extend(deckorate,{VariablesEditor:function(){function t(t){this.ed=$(t).closest("._variablesEditor")}return t.prototype.form=function(){return this.ed.closest("form")},t.prototype.submitButton=function(){return this.form().find(".submit-button")},t.prototype.variableClass=function(){return deckorate.Variable},t.prototype.variables=function(){var t,r,e,i,n,o;for(e=this.variableClass(),o=[],t=0,i=(n=this.ed.find("._filtered-list-item")).length;t<i;t++)r=n[t],o.push(new e(r));return o},t.prototype.hashList=function(){var t,r,e,i,n;for(i=[],t=0,r=(e=this.variables()).length;t<r;t++)n=e[t],i.push(Object.assign({},n.hash()));return i},t.prototype.json=function(){return JSON.stringify(this.hashList())},t.prototype.variable=function(t){return $(t).closest("._filtered-list-item")},t.prototype.removeVariable=function(t){return this.variable(t).remove()},t}(),Variable:function(){function t(t){this.row=$(t)}return t.prototype.metricId=function(){return this.row.find(".TYPE-metric.thumbnail").data("cardId")},t}()})}).call(this);
// formula_variables.js.coffee
(function(){var t,o,e,n=function(t,o){function e(){this.constructor=t}for(var n in o)r.call(o,n)&&(t[n]=o[n]);return e.prototype=o.prototype,t.prototype=new e,t.__super__=o.prototype,t},r={}.hasOwnProperty;decko.editors.content["._variablesEditor"]=function(){return e(this).json()},$(window).ready(function(){return $("body").on("click","._remove-variable",function(){return e(this).removeVariable(this)}),$("body").on("change","._options-scheme",function(){return e(this).setOptions($(this).val())}),$("body").on("click","._edit-variable-options",function(){return e(this).editVariableOptions(this)}),$("body").on("click","._update-formula-options",function(){return $(this).closest("._formula-options-template").data("opEd").update(),$(this).closest(".modal").modal("hide")}),$("body").on("change","._custom-formula-option",function(){return $(this).closest(".vo-radio").find("input[type=radio]").prop("checked",!0)}),$("body").on("change keyup paste","._variablesEditor ._sample-value",function(){return e(this).runSampleCalculation()}),$("body").on("focus","._variable-name",function(){return this.previousValue=$(this).val()}),$("body").on("keyup","._variable-name",function(){var t,o;return o=this.previousValue,t=$(this).val(),console.log("updating value from "+o+" to "+t),e(this).updateVariableNameInFormula(o,t),this.previousValue=t})}),decko.slot.ready(function(t){var o;if((o=t.find("> form ._formulaVariablesEditor")).length>0)return e(o).initOptions(),o.closest(".modal-dialog").addClass("modal-full")}),decko.itemAdded(function(o){var n;if(o.hasClass("_variable-row"))return(n=e(o)).setOptions($("._options-scheme").val()),n.updateFormulaInputs(),new t(o).autoName(n.variableNames())}),e=function(t){return new deckorate.FormulaVariablesEditor(t)},deckorate.FormulaVariablesEditor=function(o){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,o),e.prototype.variableClass=function(){return t},e.prototype.form=function(){return this.ed.closest("form")},e.prototype.variableNames=function(){var t,o,e,n,r;for(n=[],t=0,o=(e=this.variables()).length;t<o;t++)r=e[t],n.push(r.variableName().val());return n},e.prototype.variableValues=function(){var t,o,e,n,r;for(n=[],t=0,o=(e=this.variables()).length;t<o;t++)r=e[t],n.push(r.sampleInputVal());return n},e.prototype.removeVariable=function(t){return e.__super__.removeVariable.call(this,t),this.updateFormulaInputs()},e.prototype.detectOptionsScheme=function(){return this.variables().some(function(t){return!t.allResearchedOptions()})?this.variables().some(function(t){return!t.anyResearchedOptions()})?"custom":"any_researched":"all_researched"},e.prototype.initOptions=function(){var t,o,e,n,r;for(t=0,o=(e=this.variables()).length;t<o;t++)e[t].initOptions();return n=this.detectOptionsScheme(),(r=this.ed.find("select._options-scheme")).val(n),r.trigger("change"),this.toggleOptionEdit(n),this.updateFormulaInputs()},e.prototype.toggleOptionEdit=function(t){return $("._edit-variable-options").toggle("custom"===t)},e.prototype.setOptions=function(t){var o,e,n,r;if(this.toggleOptionEdit(t),"custom"!==t)for(n=this.optionsFor(t),o=0,e=(r=this.variables()).length;o<e;o++)r[o].setOptions(n);return this.updateFormulaInputs()},e.prototype.optionsFor=function(t){switch(t){case"all_researched":return{};case"any_researched":return{unknown:"Unknown",not_researched:"Unknown"}}},e.prototype.editVariableOptions=function(o){var e;return e=this.ed.find("._formula-options-template").clone(),new t(this.variable(o)).initOptionEditor(e)},e.prototype.formulaEditor=function(){var t;if((t=this.form().find("._formula-editor")).length>0)return new decko.FormulaEditor(t)},e.prototype.runSampleCalculation=function(){return this.formulaEditor().runVisibleCalculation()},e.prototype.updateVariableNameInFormula=function(t,o){var e;if(o!==t&&(e=this.formulaEditor()))return e.updateVariableName(t,o)},e.prototype.updateFormulaInputs=function(){var t;if(t=this.formulaEditor())return t.requestInputs(this.json())},e.prototype.showInputs=function(t){var o,e,n,r,i,a;for(t||(t=[]),i=[],e=o=0,n=(r=this.variables()).length;o<n;e=++o)a=r[e],i.push(a.sampleInput().val(JSON.stringify(t[e])));return i},e}(deckorate.VariablesEditor),o=function(){function t(t,o){this.opEd=t,this.variable=o,this.opEd.data("opEd",this)}return t.prototype.init=function(){return this.opEd.showAsModal(this.variable.row),this.opEd.closest(".modal-dialog").addClass("modal-lg"),this.interpret()},t.prototype.interpret=function(){var t;return t=this.variable.options(),this.setRadioVal("unknown",t.unknown||"result_unknown"),this.setRadioVal("not_researched",t.not_researched||"no_result"),this.setTextVal("year",t.year),this.setTextVal("company",t.company)},t.prototype.input=function(t){return this.opEd.find("[name=vo-"+t+"]")},t.prototype.textVal=function(t){return this.input(t).val()},t.prototype.setTextVal=function(t,o){return this.input(t).val(o)},t.prototype.radioVal=function(t){var o;return"custom"===(o=this.input(t).filter(":checked").val())?this.textVal(t+"-custom"):o},t.prototype.setRadioVal=function(t,o){var e,n;return 0===(e=(n=this.input(t)).filter("[value="+o+"]")).length&&(e=n.filter("[value=custom]"),this.setTextVal(t+"-custom",o)),e.prop("checked",!0)},t.prototype.hash=function(){return{unknown:this.radioVal("unknown"),not_researched:this.radioVal("not_researched"),year:this.textVal("year"),company:this.textVal("company")}},t.prototype.update=function(){return this.variable.setOptions(this.hash()),e(this.variable.row).updateFormulaInputs()},t}(),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.variableName=function(){return this.row.find("._variable-name")},e.prototype.hash=function(){var t;return(t=Object.assign({},this.options())).metric="~"+this.metricId(),t.name=this.variableName().val(),t},e.prototype.options=function(){return this.optionsList().data("options")},e.prototype.optionsList=function(){return this.row.find("._formula_options")},e.prototype.initOptionEditor=function(t){return this.optionEditor=new o(t,this),this.optionEditor.init()},e.prototype.initOptions=function(){if(this.setOptions(this.options()),!this.variableName().val())return this.autoName([])},e.prototype.setOptions=function(t){return this.cleanOptions(t),this.optionsList().data("options",t),this.publishOptions()},e.prototype.cleanOptions=function(t){var o,e,n,r,i;for("result_unknown"===t.unknown&&delete t.unknown,"no_result"===t.not_researched&&delete t.not_researched,i=[],o=0,n=(r=Object.keys(t)).length;o<n;o++)t[e=r[o]]?i.push(void 0):i.push(delete t[e]);return i},e.prototype.publishOptions=function(){var t,o,e,n,r;if((o=this.optionsList()).children().remove(),this.allResearchedOptions())return o.html("<div class='text-muted'>(default)</div>");for(t in n=[],e=this.options())r=e[t],n.push(o.append("<div class='small'><label>"+t+"</label>: "+r+"</div>"));return n},e.prototype.optionsLength=function(){return Object.keys(this.options()).length},e.prototype.allResearchedOptions=function(){return 0===this.optionsLength()},e.prototype.anyResearchedOptions=function(){var t;return t=this.options(),2===this.optionsLength()&&"Unknown"===t.not_researched&&"Unknown"===t.unknown},e.prototype.sampleInput=function(){return this.row.find("._sample-value")},e.prototype.sampleInputVal=function(){var t;return(t=this.sampleInput().val())?$.parseJSON(t):""},e.prototype.autoName=function(t){var o,e,n;for(e=this.row.find(".thumbnail-title .card-title").html().split(" ").find(function(o){return!t.includes(o)}),n=1;!e;)o="m"+n,t.includes(o)?n+=1:e=o;return this.variableName().val(e)},e}(deckorate.Variable)}).call(this);
// metric_formula.js.coffee
(function(){var drCalculator,dumbEval,formEd,getRegionData,initFormulaEditor;$(window).ready(function(){return $("body").on("click","._formula-input-links a",function(){return formEd(this).showInputs($(this).data("inputIndex"))})}),decko.slot.ready(function(t){var r;if((r=t.find("> form ._formula-editor"))[0]&&!r.data("editorInitialized"))return setTimeout(function(){return initFormulaEditor()},20),r.data("editorInitialized",!0)}),initFormulaEditor=function(){var t,r;if(t=(r=$("._formula-editor .codemirror-editor-textarea")).data("codeMirror"))return getRegionData(),r.closest(".modal-dialog").addClass("modal-full"),t.on("changes",function(){var t;return(t=formEd(r)).runVisibleCalculation(),t.runCalculations()})},getRegionData=function(){return $.get(decko.path("mod/wikirate_companies/region.json"),function(t){return deckorate.region=t})},formEd=function(t){return new decko.FormulaEditor(t)},decko.FormulaEditor=function(){function t(t){this.ed=$(t).closest("._formula-editor"),this.area=this.ed.find(".codemirror-editor-textarea").data("codeMirror"),this.slot=this.ed.slot(),this.form=this.ed.closest("form"),this.isScore=this.slot.find("._scoreVariablesEditor").length>0}return t.prototype.requestInputs=function(t){var r;return r=this,$.ajax({url:decko.path("?"+$.param(this.requestInputsParams(t))),success:function(t){return r.updateInputs(t)},error:function(t,e){return r.slot.notify("error: "+e,"error")}})},t.prototype.requestInputsParams=function(t){return{assign:!0,view:"input_lists",format:"json",card:{name:this.ed.data("metricName"),type:":metric",fields:{":variables":t,":metric_type":"Formula"}}}},t.prototype.updateInputs=function(t){return this.ed.data("inputs",t),this.showInputs(0),this.runCalculations(),this.updateAnswers()},t.prototype.inputs=function(){return this.ed.data("inputs")},t.prototype.updateAnswers=function(){var t;return t=this.inputs(),$("._ab-total").html(t.total),$("._ab-result-unknown").toggle(t.unknown>0),$("._ab-result-unknown-count").html(t.unknown),$("._ab-sample-size").html(t.sample.length)},t.prototype.variableEditor=function(){var t,r;return r=this.form.find("._variablesEditor"),t=this.isScore?"ScoreVariableEditor":"FormulaVariablesEditor",new deckorate[t](r)},t.prototype.showInputs=function(t){return this.variableEditor().showInputs(this.inputs().sample[t]),this.runVisibleCalculation()},t.prototype.runCalculations=function(){var t,r;return t=this.calculator(),r={known:[],unknown:[],error:[]},this.submitButton(!1),t._formula&&(this.runEachCalculation(t,r),0===r.error.length&&this.submitButton(!0)),this.publishResults(r)},t.prototype.runEachCalculation=function(t,r){var e,i,n,o,a,u,s,l,c;for(c=[],e=n=0,a=(l=this.inputs().sample).length;n<a;e=++n){i=l[e],o="known",u="";try{"Unknown"===(s=t._simple_run(i))?o="unknown":"number"==typeof s?!isNaN(s)&&isFinite(s)||(o="error"):s||(o="error"),u=s}catch(p){o="error",u=p.message}c.push(r[o].push({index:e,message:u}))}return c},t.prototype.submitButton=function(t){return this.form.find(".submit-button").prop("disabled",!t)},t.prototype.publishResults=function(t){var r,e,i,n,o,a,u,s,l;for(l=[],e=0,n=(s=Object.keys(t)).length;e<n;e++)i=s[e],(r=$("._ab-sample-"+i)).find("._result-count").html(t[i].length),(a=r.find("._formula-input-links")).html(""),l.push(function(){var r,e,n,s;for(s=[],r=0,e=(n=t[i]).length;r<e;r++)u=n[r],(o=$("<a><i></i></a>")).data("inputIndex",u.index),o.attr("title",u.message),s.push(a.append(o));return s}());return l},t.prototype.calculator=function(){return new drCalculator(this.rawFormula(),this.variableEditor().variableNames(),this.ed)},t.prototype.runVisibleCalculation=function(){var t;return t=this.calculator()._run(this.variableEditor().variableValues()),this.ed.find("._sample-result-value").html(t)},t.prototype.rawFormula=function(){return this.area?this.area.getValue():$("._formula-editor .codemirror-editor-textarea").val()},t.prototype.updateVariableName=function(t,r){var e,i;if(t&&t!==r)return i=new RegExp(t,"g"),e=this.rawFormula().replace(i,r),this.area.getDoc().setValue(e)},t}(),drCalculator=function(){function t(t,r,e){this._rawFormula=t,this._variableNames=r,this._ed=e,this._formula=this._compile()}return t.prototype._run=function(t){if(!this._formula)return"invalid formula";try{return this._simple_run(t)}catch(r){return r.message}},t.prototype._simple_run=function(t){return dumbEval(this._formula,t)},t.prototype._compile=function(){var t;return(t=this._formulaJS()).trim()?this._setVariablesJS()+"\n"+t:""},t.prototype._setVariablesJS=function(){var t,r,e,i,n;for(n="",t=r=0,e=(i=this._variableNames).length;r<e;t=++r)n+=i[t]+" = inputList["+t+"];\n";return n},t.prototype._formulaJS=function(){var t,r;try{return r=CoffeeScript.compile(this._rawFormula,{bare:!0}),this._publish(r,""),r}catch(e){return t=e,this._publish(t,t),""}},t.prototype._publish=function(t,r){return this._ed.find("._formula-as-javascript").html(t),this._ed.slot().notify(r)},t}(),dumbEval=function(formula,inputList){return deckorate._addFormulaFunctions(this),eval(formula)}}).call(this);
// rubric.js.coffee
(function(){var t,r,n,e=function(t,r){function n(){this.constructor=t}for(var e in r)o.call(r,e)&&(t[e]=r[e]);return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t},o={}.hasOwnProperty;decko.editors.content[".pairs-editor"]=function(){return JSON.stringify(t(this))},decko.slot.ready(function(t){var r;if((r=t.find("> form ._scoreVariablesEditor")).length>0)return n(r).updateFormulaInputs()}),n=function(t){return new deckorate.ScoreVariableEditor(t)},t=function(t){var n;return n={},r(t).each(function(){var t,r;if(t=$(this).find("td"),r=$(t[0]).data("key"))return n[r]=$(t[1]).find("input").val()}),n},r=function(t){return t.find("tbody tr")},deckorate.ScoreVariableEditor=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.variableNames=function(){return["answer"]},r.prototype.sampleValueInput=function(){return this.ed.find("._sample-value")},r.prototype.variableValues=function(){return[$.parseJSON(this.sampleValueInput().val())]},r.prototype.hashList=function(){return this.ed.data("variablesJson")},r.prototype.showInputs=function(t){return this.sampleValueInput().val(t[0])},r}(deckorate.FormulaVariablesEditor)}).call(this);
// wikirating.js.coffee
(function(){var t,i,e,r=function(t,i){function e(){this.constructor=t}for(var r in i)n.call(i,r)&&(t[r]=i[r]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t},n={}.hasOwnProperty;decko.editors.content[".wikiRating-editor"]=function(){return e(this).json()},decko.slot.ready(function(){var t;if($(".metric-weight input").on("keyup",function(){return e(this).checkEqualization()}),$("#equalizer").on("click",function(){if(!0===$(this).prop("checked"))return e(this).equalize()}),(t=$("._wikiRating-editor")).length>0)return e(t).validate()}),decko.itemsAdded(function(t){var i;if((i=t.find(".wikiRating-editor"))[0])return e(i).validate()}),$(window).ready(function(){return $("body").on("input",".metric-weight input",function(){return e(this).validate()}),$("body").on("click","._remove-weight",function(){return e(this).removeVariable(this)})}),e=function(t){return new i(t)},i=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,i),e.prototype.variableClass=function(){return t},e.prototype.weights=function(){var t,i,e,r,n;for(r=[],t=0,i=(e=this.variables()).length;t<i;t++)n=e[t],r.push(n.weight());return r},e.prototype.checkEqualization=function(){return $("#equalizer").prop("checked",this.areEqual())},e.prototype.areEqual=function(){return!0===this.weights().every(function(t,i,e){return t===e[0]})},e.prototype.removeVariable=function(t){return e.__super__.removeVariable.call(this,t),this.equalize()},e.prototype.equalize=function(){var t,i,e,r;for(r=(100/(e=this.variables()).length).toFixed(2),t=0,i=e.length;t<i;t++)e[t].setWeight(r);return this.validate()},e.prototype.validate=function(){var t,i;return i=(t=this.total())>99.9&&t<=100.09&&!this.invalidWeight(),this.submitButton().prop("disabled",!i)},e.prototype.invalidWeight=function(){return this.variables().find(function(t){return t.isInvalid()})},e.prototype.total=function(){var t;return t=this.weights().reduce(function(t,i){return t+i},0).toFixed(2),this.ed.find(".weight-sum").val(t),t},e}(deckorate.VariablesEditor),t=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return r(i,t),i.prototype.hash=function(){return{metric:"~"+this.metricId(),weight:this.weight()}},i.prototype.weightInput=function(){return this.row.find(".metric-weight input")},i.prototype.weight=function(){return parseFloat(this.weightInput().val())},i.prototype.setWeight=function(t){return this.weightInput().val(t)},i.prototype.isInvalid=function(){var t;return t=this.weight(),isNaN(t)||t<=0||t>100},i}(deckorate.Variable)}).call(this);
// formula.js
function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}!function(n,r){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((n="undefined"!=typeof globalThis?globalThis:n||self).formulajs={})}(this,function(n){"use strict";function r(n){return n&&n.reduce?n.reduce(function(n,r){var t=Array.isArray(n),e=Array.isArray(r);return t&&e?n.concat(r):t?(n.push(r),n):e?[n].concat(r):[n,r]}):n}function t(n){if(!n)return!1;for(var r=0;r<n.length;++r)if(Array.isArray(n[r]))return!1;return!0}function e(){for(var n=o.apply(null,arguments);!t(n);)n=r(n);return n}function o(n){var r=[];return M(n,function(n){r.push(n)}),r}function u(){return e.apply(null,arguments).filter(function(n){return"number"==typeof n})}function i(n){var r=1e14;return Math.round(n*r)/r}function a(n){if("boolean"==typeof n)return n;if(n instanceof Error)return n;if("number"==typeof n)return 0!==n;if("string"==typeof n){var r=n.toUpperCase();if("TRUE"===r)return!0;if("FALSE"===r)return!1}return n instanceof Date&&!isNaN(n)||kn}function f(n){return n instanceof Error?n:null==n||""===n?0:("boolean"==typeof n&&(n=+n),isNaN(n)?kn:parseFloat(n))}function c(n){return n instanceof Error?n:null==n?"":n.toString()}function l(n){var r,t;if(!n||0===(r=n.length))return kn;for(;r--;){if(n[r]instanceof Error)return n[r];if((t=f(n[r]))instanceof Error)return t;n[r]=t}return n}function s(n){if(!isNaN(n)){if(n instanceof Date)return new Date(n);var r=parseFloat(n);return r<0||r>=2958466?Hn:function(n){n<60&&(n+=1);var r=Math.floor(n-25569),t=new Date(86400*r*1e3),e=n-Math.floor(n)+1e-7,o=Math.floor(86400*e),u=o%60;o-=u;var i=Math.floor(o/3600),a=Math.floor(o/60)%60,f=t.getDate(),c=t.getMonth();return n>=60&&n<61&&(f=29,c=1),new Date(t.getFullYear(),c,f,i,a,u)}(r)}return"string"!=typeof n||(n=new Date(n),isNaN(n))?kn:n}function h(n){for(var r,t=n.length;t--;){if((r=s(n[t]))===kn)return r;n[t]=r}return n}function g(){for(var n=0;n<arguments.length;n++)if(arguments[n]instanceof Error)return arguments[n]}function p(n){return null!=n}function v(){for(var n=arguments.length;n--;)if(arguments[n]instanceof Error)return!0;return!1}function m(){for(var n=arguments.length;n--;)if("string"==typeof arguments[n])return!0;return!1}function d(n){for(var r,t=n.length;t--;)if("number"!=typeof(r=n[t]))if(!0!==r)if(!1!==r){if("string"==typeof r){var e=f(r);e instanceof Error?n[t]=0:n[t]=e}}else n[t]=0;else n[t]=1;return n}function E(n,r){return r=r||1,n&&"function"==typeof n.slice?n.slice(r):n}function M(n,r){for(var t=-1,e=n.length;++t<e&&!1!==r(n[t],t,n););return n}function N(n){var r=new Date(n);return r.setHours(0,0,0,0),r}function w(n,r){return n=s(n),r=s(r),n instanceof Error?n:r instanceof Error?r:R(N(n))-R(N(r))}function I(n,r,t){if(t=a(t||"false"),n=s(n),r=s(r),n instanceof Error)return n;if(r instanceof Error)return r;if(t instanceof Error)return t;var e,o,u=n.getMonth(),i=r.getMonth();if(t)e=31===n.getDate()?30:n.getDate(),o=31===r.getDate()?30:r.getDate();else{var f=new Date(n.getFullYear(),u+1,0).getDate(),c=new Date(r.getFullYear(),i+1,0).getDate();e=n.getDate()===f?30:n.getDate(),r.getDate()===c?e<30?(i++,o=1):o=30:o=r.getDate()}return 360*(r.getFullYear()-n.getFullYear())+30*(i-u)+(o-e)}function y(n){if((n=s(n))instanceof Error)return n;(n=N(n)).setDate(n.getDate()+4-(n.getDay()||7));var r=new Date(n.getFullYear(),0,1);return Math.ceil(((n-r)/864e5+1)/7)}function b(n,r,t){return b.INTL(n,r,1,t)}function T(n,r,t){return T.INTL(n,r,1,t)}function S(n){return 1===new Date(n,1,29).getMonth()}function A(n,r){return Math.ceil((r-n)/1e3/60/60/24)}function D(n,r,t){if((n=s(n))instanceof Error)return n;if((r=s(r))instanceof Error)return r;t=t||0;var e=n.getDate(),o=n.getMonth()+1,u=n.getFullYear(),i=r.getDate(),a=r.getMonth()+1,f=r.getFullYear();switch(t){case 0:return 31===e&&31===i?(e=30,i=30):31===e?e=30:30===e&&31===i&&(i=30),(i+30*a+360*f-(e+30*o+360*u))/360;case 1:var c=365;if(u===f||u+1===f&&(o>a||o===a&&e>=i))return(u===f&&S(u)||function(n,r){var t=n.getFullYear(),e=new Date(t,2,1);if(S(t)&&n<e&&r>=e)return!0;var o=r.getFullYear(),u=new Date(o,2,1);return S(o)&&r>=u&&n<u}(n,r)||1===a&&29===i)&&(c=366),A(n,r)/c;var l=f-u+1,h=(new Date(f+1,0,1)-new Date(u,0,1))/1e3/60/60/24/l;return A(n,r)/h;case 2:return A(n,r)/360;case 3:return A(n,r)/365;case 4:return(i+30*a+360*f-(e+30*o+360*u))/360}}function R(n){var r=n>-22038912e5?2:1;return Math.ceil((n-Kn)/864e5)+r}function C(n){return 0===(n=f(n))?kn:n instanceof Error?n:String.fromCharCode(n)}function x(n){if(v(n))return n;var r=(n=n||"").charCodeAt(0);return isNaN(r)&&(r=kn),r}function O(){var n=e(arguments),r=g.apply(void 0,n);if(r)return r;for(var t=0;(t=n.indexOf(!0))>-1;)n[t]="TRUE";for(var o=0;(o=n.indexOf(!1))>-1;)n[o]="FALSE";return n.join("")}function P(n,r){return g(n,r)||(n=c(n),(r=f(r))instanceof Error?r:new Array(r+1).join(n))}function L(n){return/^[01]{1,10}$/.test(n)}function q(n,r,t){if(v(n=f(n),r=f(r)))return n;if("i"!==(t=void 0===t?"i":t)&&"j"!==t)return kn;if(0===n&&0===r)return 0;if(0===n)return 1===r?t:r.toString()+t;if(0===r)return n.toString();var e=r>0?"+":"";return n.toString()+e+(1===r?t:r.toString()+t)}function U(n,r){return r=void 0===r?0:r,v(n=f(n),r=f(r))?kn:nr.erf(n)}function F(n){return isNaN(n)?kn:nr.erfc(n)}function _(n){var r=H(n),t=V(n);return v(r,t)?kn:Math.sqrt(Math.pow(r,2)+Math.pow(t,2))}function V(n){if(void 0===n||!0===n||!1===n)return kn;if(0===n||"0"===n)return 0;if(["i","j"].indexOf(n)>=0)return 1;var r=(n=(n+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),t=n.indexOf("-");0===r&&(r=n.indexOf("+",1)),0===t&&(t=n.indexOf("-",1));var e=n.substring(n.length-1,n.length),o="i"===e||"j"===e;return r>=0||t>=0?o?r>=0?isNaN(n.substring(0,r))||isNaN(n.substring(r+1,n.length-1))?Hn:Number(n.substring(r+1,n.length-1)):isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?Hn:-Number(n.substring(t+1,n.length-1)):Hn:o?isNaN(n.substring(0,n.length-1))?Hn:n.substring(0,n.length-1):isNaN(n)?Hn:0}function G(n){var r=H(n),t=V(n);return v(r,t)?kn:0===r&&0===t?Gn:0===r&&t>0?Math.PI/2:0===r&&t<0?-Math.PI/2:0===t&&r>0?0:0===t&&r<0?-Math.PI:r>0?Math.atan(t/r):r<0&&t>=0?Math.atan(t/r)+Math.PI:Math.atan(t/r)-Math.PI}function k(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",q(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,e)}function X(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",q(Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2,e)}function Y(n,r){var t=H(n),e=V(n),o=H(r),u=V(r);if(v(t,e,o,u))return kn;var i=n.substring(n.length-1),a=r.substring(r.length-1),f="i";if(("j"===i||"j"===a)&&(f="j"),0===o&&0===u)return Hn;var c=o*o+u*u;return q((t*o+e*u)/c,(e*o-t*u)/c,f)}function H(n){if(void 0===n||!0===n||!1===n)return kn;if(0===n||"0"===n)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(n)>=0)return 0;var r=(n+="").indexOf("+"),t=n.indexOf("-");0===r&&(r=n.indexOf("+",1)),0===t&&(t=n.indexOf("-",1));var e=n.substring(n.length-1,n.length),o="i"===e||"j"===e;return r>=0||t>=0?o?r>=0?isNaN(n.substring(0,r))||isNaN(n.substring(r+1,n.length-1))?Hn:Number(n.substring(0,r)):isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?Hn:Number(n.substring(0,t)):Hn:o?isNaN(n.substring(0,n.length-1))?Hn:0:isNaN(n)?Hn:n}function j(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",q(Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,e)}function B(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",q(Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,e)}function z(n,r){if(-1===ar.indexOf(r))throw new Error("Unsupported token type: "+r);return{value:n,type:r}}function K(n){for(var r="",t=[],e=0;e<n.length;e++){var o=n[e];0===e&&or.indexOf(o)>=0?t.push(z(o,fr)):r+=o}return r.length>0&&t.push(z(function(n){return"string"!=typeof n||/^\d+(\.\d+)?$/.test(n)&&(n=-1===n.indexOf(".")?parseInt(n,10):parseFloat(n)),n}(r),cr)),t.length>0&&t[0].type!==fr&&t.unshift(z("=",fr)),t}function W(n){return K(function(n){for(var r=n.length,t=[],e=0,o="",u="";e<r;){var i=n.charAt(e);switch(i){case">":case"<":case"=":u+=i,o.length>0&&(t.push(o),o="");break;default:u.length>0&&(t.push(u),u=""),o+=i}e++}return o.length>0&&t.push(o),u.length>0&&t.push(u),t}(n))}function Q(n){return[kn,Xn,Gn,Hn,Yn,Vn].indexOf(n)>=0||"number"==typeof n&&(isNaN(n)||!isFinite(n))}function $(n){return Q(n)||n===jn}function Z(n){return!0===n||!1===n}function J(n){return"number"==typeof n&&!isNaN(n)&&isFinite(n)}function nn(n){return"string"==typeof n}function rn(){for(var n=[],r=0;r<arguments.length;++r){for(var t=!1,e=arguments[r],o=0;o<n.length&&!(t=n[o]===e);++o);t||n.push(e)}return n}function tn(){var n=e(arguments).filter(p);if(0===n.length)return Gn;var r=g.apply(void 0,n);if(r)return r;for(var t,o=u(n),i=o.length,a=0,f=0,c=0;c<i;c++)a+=o[c],f+=1;return t=a/f,isNaN(t)&&(t=Hn),t}function en(){var n=e(arguments).filter(p);if(0===n.length)return Gn;var r=g.apply(void 0,n);if(r)return r;for(var t,o=n,u=o.length,i=0,a=0,f=0;f<u;f++){var c=o[f];"number"==typeof c&&(i+=c),!0===c&&i++,null!==c&&a++}return t=i/a,isNaN(t)&&(t=Hn),t}function on(){return u(e(arguments)).length}function un(){var n=e(arguments);return n.length-an(n)}function an(){for(var n,r=e(arguments),t=0,o=0;o<r.length;o++)null!=(n=r[o])&&""!==n||t++;return t}function fn(n,r,t){if(v(n=f(n),r=l(e(r)),t=l(e(t))))return kn;for(var o=nr.mean(t),u=nr.mean(r),i=t.length,a=0,c=0,s=0;s<i;s++)a+=(t[s]-o)*(r[s]-u),c+=Math.pow(t[s]-o,2);var h=a/c;return u-h*o+h*n}function cn(n){return(n=f(n))instanceof Error?n:0===n||parseInt(n,10)===n&&n<0?Hn:nr.gammafn(n)}function ln(n){return(n=f(n))instanceof Error?n:nr.gammaln(n)}function sn(n,r){return v(n=l(e(n)),r=f(r))?n:r<0||n.length<r?kn:n.sort(function(n,r){return r-n})[r-1]}function hn(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;for(var t=nr.mean(n),o=nr.mean(r),u=r.length,i=0,a=0,f=0;f<u;f++)i+=(r[f]-o)*(n[f]-t),a+=Math.pow(r[f]-o,2);var c=i/a;return[c,t-c*o]}function gn(){var n=e(arguments),r=g.apply(void 0,n);if(r)return r;var t=u(n);return 0===t.length?0:Math.max.apply(Math,t)}function pn(){var n=e(arguments),r=g.apply(void 0,n);if(r)return r;var t=d(n),o=nr.median(t);return isNaN(o)&&(o=Hn),o}function vn(){var n=e(arguments),r=g.apply(void 0,n);if(r)return r;var t=u(n);return 0===t.length?0:Math.min.apply(Math,t)}function mn(n,r){if(v(r=l(e(r)),n=l(e(n))))return kn;for(var t=nr.mean(n),o=nr.mean(r),u=n.length,i=0,a=0,f=0,c=0;c<u;c++)i+=(n[c]-t)*(r[c]-o),a+=Math.pow(n[c]-t,2),f+=Math.pow(r[c]-o,2);return i/Math.sqrt(a*f)}function dn(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=nr.mean(n),t=n.length,o=0,u=0;u<t;u++)o+=Math.pow(n[u]-r,3);return t*o/((t-1)*(t-2)*Math.pow(nr.stdev(n,!0),3))}function En(n,r){return v(n=l(e(n)),r=f(r))?n:n.sort(function(n,r){return n-r})[r-1]}function Mn(){for(var n=e(arguments),r=n.length,t=0,o=0,u=en(n),i=0;i<r;i++){var a=n[i];t+="number"==typeof a?Math.pow(a-u,2):!0===a?Math.pow(1-u,2):Math.pow(0-u,2),null!==a&&o++}return t/(o-1)}function Nn(){for(var n,r=e(arguments),t=r.length,o=0,u=0,i=en(r),a=0;a<t;a++){var f=r[a];o+="number"==typeof f?Math.pow(f-i,2):!0===f?Math.pow(1-i,2):Math.pow(0-i,2),null!==f&&u++}return n=o/u,isNaN(n)&&(n=Hn),n}function wn(n,r,t){var e=g(n=f(n),r=f(r),t=f(t));if(e)return e;if(0===r)return 0;r=Math.abs(r);var o=-Math.floor(Math.log(r)/Math.log(10));return n>=0?An(Math.ceil(n/r)*r,o):0===t?-An(Math.floor(Math.abs(n)/r)*r,o):-An(Math.ceil(Math.abs(n)/r)*r,o)}function In(n,r){return g(n=f(n),r=f(r))||(n<r?Hn:yn(n)/(yn(r)*yn(n-r)))}function yn(n){if((n=f(n))instanceof Error)return n;var r=Math.floor(n);return 0===r||1===r?1:(qr[r]>0||(qr[r]=yn(r-1)*r),qr[r])}function bn(n,r){var t=g(n=f(n),r=f(r));if(t)return t;if(0===r)return 0;if(!(n>=0&&r>0||n<=0&&r<0))return Hn;r=Math.abs(r);var e=-Math.floor(Math.log(r)/Math.log(10));return n>=0?An(Math.floor(n/r)*r,e):-An(Math.ceil(Math.abs(n)/r),e)}function Tn(n,r){var t=g(n=f(n),r=f(r));if(t)return t;if(0===n&&0===r)return Hn;var e=Math.pow(n,r);return isNaN(e)?Hn:e}function Sn(){var n=e(arguments).filter(function(n){return null!=n});if(0===n.length)return 0;var r=l(n);if(r instanceof Error)return r;for(var t=1,o=0;o<r.length;o++)t*=r[o];return t}function An(n,r){return g(n=f(n),r=f(r))||Math.round(n*Math.pow(10,r))/Math.pow(10,r)}function Dn(){var n=0;return M(o(arguments),function(r){if(n instanceof Error)return!1;if(r instanceof Error)n=r;else if("number"==typeof r)n+=r;else if("string"==typeof r){var t=parseFloat(r);!isNaN(t)&&(n+=t)}else if(Array.isArray(r)){var e=Dn.apply(null,r);e instanceof Error?n=e:n+=e}}),n}function Rn(n){var r=[];return M(n,function(n){n&&r.push(n)}),r}function Cn(n,r){var t=null;return M(n,function(n,e){if(n[0]===r)return t=e,!1}),null==t?kn:t}function xn(n,r){for(var t={},e=1;e<n[0].length;++e)t[e]=!0;for(var o=r[0].length,u=1;u<r.length;++u)r[u].length>o&&(o=r[u].length);for(var i=1;i<n.length;++i)for(var a=1;a<n[i].length;++a){for(var f=!1,c=!1,l=0;l<r.length;++l){var s=r[l];if(!(s.length<o)){var h=s[0];if(n[i][0]===h){c=!0;for(var g=1;g<s.length;++g)if(!f)if(void 0===s[g]||"*"===s[g])f=!0;else{var p=W(s[g]+""),v=[z(n[i][a],cr)].concat(p);f=lr(v)}}}}c&&(t[a]=t[a]&&f)}for(var m=[],d=0;d<n[0].length;++d)t[d]&&m.push(d-1);return m}function On(n){return n&&n.getTime&&!isNaN(n.getTime())}function Pn(n){return n instanceof Date?n:new Date(n)}function Ln(n,r,t,e,o){if(e=e||0,o=o||0,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o)))return kn;var u;if(0===n)u=e+t*r;else{var i=Math.pow(1+n,r);u=1===o?e*i+t*(1+n)*(i-1)/n:e*i+t*(i-1)/n}return-u}function qn(n,r,t,e,o,u){if(o=o||0,u=u||0,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o),u=f(u)))return kn;var i=Fn(n,t,e,o,u);return(1===r?1===u?0:-e:1===u?Ln(n,r-2,i,e,1)-i:Ln(n,r-1,i,e,0))*n}function Un(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=n[0],t=0,o=1;o<n.length;o++)t+=n[o]/Math.pow(1+r,o);return t}function Fn(n,r,t,e,o){if(e=e||0,o=o||0,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o)))return kn;var u;if(0===n)u=(t+e)/r;else{var i=Math.pow(1+n,r);u=1===o?(e*n/(i-1)+t*n/(1-1/i))/(1+n):e*n/(i-1)+t*n/(1-1/i)}return-u}function _n(n,r,t,e){if(!r||!t)return jn;e=!(0===e||!1===e);for(var o=jn,u="number"==typeof n,i=!1,a=0;a<r.length;a++){var f=r[a];if(f[0]===n){o=t<f.length+1?f[t-1]:Xn;break}!i&&(u&&e&&f[0]<=n||e&&"string"==typeof f[0]&&f[0].localeCompare(n)<0)&&(o=t<f.length+1?f[t-1]:Xn),u&&f[0]>n&&(i=!0)}return o}var Vn=new Error("#NULL!"),Gn=new Error("#DIV/0!"),kn=new Error("#VALUE!"),Xn=new Error("#REF!"),Yn=new Error("#NAME?"),Hn=new Error("#NUM!"),jn=new Error("#N/A"),Bn=new Error("#ERROR!"),zn=new Error("#GETTING_DATA"),Kn=new Date(Date.UTC(1900,0,1)),Wn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Qn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],$n=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];b.INTL=function(n,r,t,e){if((n=s(n))instanceof Error)return n;if((r=s(r))instanceof Error)return r;var o=!1,u=[],i=[1,2,3,4,5,6,0],a=new RegExp("^[0|1]{7}$");if(void 0===t)t=$n[1];else if("string"==typeof t&&a.test(t)){o=!0,t=t.split("");for(var f=0;f<t.length;f++)"1"===t[f]&&u.push(i[f])}else t=$n[t];if(!(t instanceof Array))return kn;void 0===e?e=[]:e instanceof Array||(e=[e]);for(var c=0;c<e.length;c++){var l=s(e[c]);if(l instanceof Error)return l;e[c]=l}for(var h=Math.round((r-n)/864e5)+1,g=h,p=n,v=0;v<h;v++){for(var m=(new Date).getTimezoneOffset()>0?p.getUTCDay():p.getDay(),d=o?u.includes(m):m===t[0]||m===t[1],E=0;E<e.length;E++){var M=e[E];if(M.getDate()===p.getDate()&&M.getMonth()===p.getMonth()&&M.getFullYear()===p.getFullYear()){d=!0;break}}d&&g--,p.setDate(p.getDate()+1)}return g},T.INTL=function(n,r,t,e){if((n=s(n))instanceof Error)return n;if((r=f(r))instanceof Error)return r;if(r<0)return Hn;if(!((t=void 0===t?$n[1]:$n[t])instanceof Array))return kn;void 0===e?e=[]:e instanceof Array||(e=[e]);for(var o=0;o<e.length;o++){var u=s(e[o]);if(u instanceof Error)return u;e[o]=u}for(var i=0;i<r;){n.setDate(n.getDate()+1);var a=n.getDay();if(a!==t[0]&&a!==t[1]){for(var c=0;c<e.length;c++){var l=e[c];if(l.getDate()===n.getDate()&&l.getMonth()===n.getMonth()&&l.getFullYear()===n.getFullYear()){i--;break}}i++}}return n},"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Zn={};!function(){var n;n=function(n){function r(n,r){for(var t=0,e=0;t<n.length;++t)e=r*e+n[t];return e}function t(n,r,t,e,o){if(0===r)return t;if(1===r)return e;for(var u=2/n,i=e,a=1;a<r;++a)i=e*a*u+o*t,t=e,e=i;return i}function e(n,r,e,o,u){return function(e,i){if(o){if(0===e)return 1==o?-1/0:1/0;if(e<0)return NaN}return 0===i?n(e):1===i?r(e):i<0?NaN:t(e,i|=0,n(e),r(e),u)}}n.version="1.0.2";var o,u,i,a,f,c,l,s,h,g,p,v,m,d=Math,E=function(){function n(n){var t=0,e=0,c=0,l=n*n;if(n<8)t=(e=r(u,l))/(c=r(i,l));else{var s=n-.785398164;e=r(a,l=64/l),c=r(f,l),t=d.sqrt(o/n)*(d.cos(s)*e-d.sin(s)*c*8/n)}return t}function e(n){var t=0,e=0,u=0,i=n*n,a=d.abs(n)-2.356194491;return Math.abs(n)<8?t=(e=n*r(c,i))/(u=r(l,i)):(e=r(s,i=64/i),u=r(h,i),t=d.sqrt(o/d.abs(n))*(d.cos(a)*e-d.sin(a)*u*8/d.abs(n)),n<0&&(t=-t)),t}var o=.636619772,u=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function g(r,o){if(o=Math.round(o),!isFinite(r))return isNaN(r)?r:0;if(o<0)return(o%2?-1:1)*g(r,-o);if(r<0)return(o%2?-1:1)*g(-r,o);if(0===o)return n(r);if(1===o)return e(r);if(0===r)return 0;var u=0;if(r>o)u=t(r,o,n(r),e(r),-1);else{for(var i=!1,a=0,f=0,c=1,l=0,s=2/r,h=2*d.floor((o+d.floor(d.sqrt(40*o)))/2);h>0;h--)l=h*s*c-a,a=c,c=l,d.abs(c)>1e10&&(c*=1e-10,a*=1e-10,u*=1e-10,f*=1e-10),i&&(f+=c),i=!i,h==o&&(u=a);u/=f=2*f-c}return u}}(),M=(o=.636619772,u=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),i=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),l=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),e(function(n){var t=0,e=0,c=0,l=n*n,s=n-.785398164;return n<8?t=(e=r(u,l))/(c=r(i,l))+o*E(n,0)*d.log(n):(e=r(a,l=64/l),c=r(f,l),t=d.sqrt(o/n)*(d.sin(s)*e+d.cos(s)*c*8/n)),t},function(n){var t=0,e=0,u=0,i=n*n,a=n-2.356194491;return n<8?t=(e=n*r(c,i))/(u=r(l,i))+o*(E(n,1)*d.log(n)-1/n):(e=r(s,i=64/i),u=r(h,i),t=d.sqrt(o/n)*(d.sin(a)*e+d.cos(a)*u*8/n)),t},0,1,-1)),N=(g=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),p=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),v=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),m=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function I(n,t){if(0===(t=Math.round(t)))return function(n){return n<=3.75?r(g,n*n/14.0625):d.exp(d.abs(n))/d.sqrt(d.abs(n))*r(p,3.75/d.abs(n))}(n);if(1===t)return function(n){return n<3.75?n*r(v,n*n/14.0625):(n<0?-1:1)*d.exp(d.abs(n))/d.sqrt(d.abs(n))*r(m,3.75/d.abs(n))}(n);if(t<0)return NaN;if(0===d.abs(n))return 0;if(n==1/0)return 1/0;var e,o=0,u=2/d.abs(n),i=0,a=1,f=0;for(e=2*d.round((t+d.round(d.sqrt(40*t)))/2);e>0;e--)f=e*u*a+i,i=a,a=f,d.abs(a)>1e10&&(a*=1e-10,i*=1e-10,o*=1e-10),e==t&&(o=i);return o*=I(n,0)/a,n<0&&t%2?-o:o}),w=function(){var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),o=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),u=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return e(function(e){return e<=2?-d.log(e/2)*N(e,0)+r(n,e*e/4):d.exp(-e)/d.sqrt(e)*r(t,2/e)},function(n){return n<=2?d.log(n/2)*N(n,1)+1/n*r(o,n*n/4):d.exp(-n)/d.sqrt(n)*r(u,2/n)},0,2,1)}();n.besselj=E,n.bessely=M,n.besseli=N,n.besselk=w},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(Zn):n({})}();var Jn={exports:{}};Jn.exports=function(){var n=function(n,r){function t(r,t){var e=r>t?r:t;return n.pow(10,17-~~(n.log(e>0?e:-e)*n.LOG10E))}function e(n){return"[object Function]"===h.call(n)}function o(n){return"number"==typeof n&&n-n==0}function u(n){return l.apply([],n)}function i(){return new i._init(arguments)}function a(){return 0}function f(){return 1}function c(n,r){return n===r?1:0}var l=Array.prototype.concat,s=Array.prototype.slice,h=Object.prototype.toString,g=Array.isArray||function(n){return"[object Array]"===h.call(n)};i.fn=i.prototype,i._init=function(n){if(g(n[0]))if(g(n[0][0])){e(n[1])&&(n[0]=i.map(n[0],n[1]));for(var r=0;r<n[0].length;r++)this[r]=n[0][r];this.length=n[0].length}else this[0]=e(n[1])?i.map(n[0],n[1]):n[0],this.length=1;else if(o(n[0]))this[0]=i.seq.apply(null,n),this.length=1;else{if(n[0]instanceof i)return i(n[0].toArray());this[0]=[],this.length=1}return this},i._init.prototype=i.prototype,i._init.constructor=i,i.utils={calcRdx:t,isArray:g,isFunction:e,isNumber:o,toVector:u},i._random_fn=n.random,i.setRandom=function(n){if("function"!=typeof n)throw new TypeError("fn is not a function");i._random_fn=n},i.extend=function(n){var r,t;if(1===arguments.length){for(t in n)i[t]=n[t];return this}for(r=1;r<arguments.length;r++)for(t in arguments[r])n[t]=arguments[r][t];return n},i.rows=function(n){return n.length||1},i.cols=function(n){return n[0].length||1},i.dimensions=function(n){return{rows:i.rows(n),cols:i.cols(n)}},i.row=function(n,r){return g(r)?r.map(function(r){return i.row(n,r)}):n[r]},i.rowa=function(n,r){return i.row(n,r)},i.col=function(n,r){if(g(r)){var t=i.arange(n.length).map(function(){return new Array(r.length)});return r.forEach(function(r,e){i.arange(n.length).forEach(function(o){t[o][e]=n[o][r]})}),t}for(var e=new Array(n.length),o=0;o<n.length;o++)e[o]=[n[o][r]];return e},i.cola=function(n,r){return i.col(n,r).map(function(n){return n[0]})},i.diag=function(n){for(var r=i.rows(n),t=new Array(r),e=0;e<r;e++)t[e]=[n[e][e]];return t},i.antidiag=function(n){for(var r=i.rows(n)-1,t=new Array(r),e=0;r>=0;r--,e++)t[e]=[n[e][r]];return t},i.transpose=function(n){var r,t,e,o,u,i=[];for(g(n[0])||(n=[n]),t=n.length,e=n[0].length,u=0;u<e;u++){for(r=new Array(t),o=0;o<t;o++)r[o]=n[o][u];i.push(r)}return 1===i.length?i[0]:i},i.map=function(n,r,t){var e,o,u,i,a;for(g(n[0])||(n=[n]),o=n.length,u=n[0].length,i=t?n:new Array(o),e=0;e<o;e++)for(i[e]||(i[e]=new Array(u)),a=0;a<u;a++)i[e][a]=r(n[e][a],e,a);return 1===i.length?i[0]:i},i.cumreduce=function(n,r,t){var e,o,u,i,a;for(g(n[0])||(n=[n]),o=n.length,u=n[0].length,i=t?n:new Array(o),e=0;e<o;e++)for(i[e]||(i[e]=new Array(u)),u>0&&(i[e][0]=n[e][0]),a=1;a<u;a++)i[e][a]=r(i[e][a-1],n[e][a]);return 1===i.length?i[0]:i},i.alter=function(n,r){return i.map(n,r,!0)},i.create=function(n,r,t){var o,u,i=new Array(n);for(e(r)&&(t=r,r=n),o=0;o<n;o++)for(i[o]=new Array(r),u=0;u<r;u++)i[o][u]=t(o,u);return i},i.zeros=function(n,r){return o(r)||(r=n),i.create(n,r,a)},i.ones=function(n,r){return o(r)||(r=n),i.create(n,r,f)},i.rand=function(n,r){return o(r)||(r=n),i.create(n,r,i._random_fn)},i.identity=function(n,r){return o(r)||(r=n),i.create(n,r,c)},i.symmetric=function(n){var r,t,e=n.length;if(n.length!==n[0].length)return!1;for(r=0;r<e;r++)for(t=0;t<e;t++)if(n[t][r]!==n[r][t])return!1;return!0},i.clear=function(n){return i.alter(n,a)},i.seq=function(n,r,o,u){e(u)||(u=!1);var i,a=[],f=t(n,r),c=(r*f-n*f)/((o-1)*f),l=n;for(i=0;l<=r&&i<o;l=(n*f+c*f*++i)/f)a.push(u?u(l,i):l);return a},i.arange=function(n,t,e){var o,u=[];if(e=e||1,t===r&&(t=n,n=0),n===t||0===e)return[];if(n<t&&e<0)return[];if(n>t&&e>0)return[];if(e>0)for(o=n;o<t;o+=e)u.push(o);else for(o=n;o>t;o+=e)u.push(o);return u},i.slice=function(){function n(n,t,e,o){var u,a=[],f=n.length;if(t===r&&e===r&&o===r)return i.copy(n);if(o=o||1,(t=(t=t||0)>=0?t:f+t)===(e=(e=e||n.length)>=0?e:f+e)||0===o)return[];if(t<e&&o<0)return[];if(t>e&&o>0)return[];if(o>0)for(u=t;u<e;u+=o)a.push(n[u]);else for(u=t;u>e;u+=o)a.push(n[u]);return a}function t(r,t){var e,u;return o((t=t||{}).row)?o(t.col)?r[t.row][t.col]:n(i.rowa(r,t.row),(e=t.col||{}).start,e.end,e.step):o(t.col)?n(i.cola(r,t.col),(u=t.row||{}).start,u.end,u.step):(u=t.row||{},e=t.col||{},n(r,u.start,u.end,u.step).map(function(r){return n(r,e.start,e.end,e.step)}))}return t}(),i.sliceAssign=function(t,e,u){var a,f;if(o(e.row)){if(o(e.col))return t[e.row][e.col]=u;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,a=i.arange(e.col.start,n.min(t.length,e.col.end),e.col.step);var c=e.row;return a.forEach(function(n,r){t[c][n]=u[r]}),t}if(o(e.col)){e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,f=i.arange(e.row.start,n.min(t[0].length,e.row.end),e.row.step);var l=e.col;return f.forEach(function(n,r){t[n][l]=u[r]}),t}return u[0].length===r&&(u=[u]),e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,f=i.arange(e.row.start,n.min(t.length,e.row.end),e.row.step),a=i.arange(e.col.start,n.min(t[0].length,e.col.end),e.col.step),f.forEach(function(n,r){a.forEach(function(e,o){t[n][e]=u[r][o]})}),t},i.diagonal=function(n){var r=i.zeros(n.length,n.length);return n.forEach(function(n,t){r[t][t]=n}),r},i.copy=function(n){return n.map(function(n){return o(n)?n:n.map(function(n){return n})})};var p=i.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},p.map=function(n,r){return i(i.map(this,n,r))},p.cumreduce=function(n,r){return i(i.cumreduce(this,n,r))},p.alter=function(n){return i.alter(this,n),this},function(n){for(var r=0;r<n.length;r++)!function(n){p[n]=function(r){var t,e=this;return r?(setTimeout(function(){r.call(e,p[n].call(e))}),this):(t=i[n](this),g(t)?i(t):t)}}(n[r])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){p[n]=function(r,t){var e=this;return t?(setTimeout(function(){t.call(e,p[n].call(e,r))}),this):i(i[n](this,r))}}(n[r])}("row col".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){p[n]=function(){return i(i[n].apply(null,arguments))}}(n[r])}("create zeros ones rand identity".split(" ")),i}(Math);return function(n,r){function t(n,r){return n-r}function e(n,t,e){return r.max(t,r.min(n,e))}var o=n.utils.isFunction;n.sum=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t];return r},n.sumsqrd=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t]*n[t];return r},n.sumsqerr=function(r){for(var t,e=n.mean(r),o=0,u=r.length;--u>=0;)o+=(t=r[u]-e)*t;return o},n.sumrow=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t];return r},n.product=function(n){for(var r=1,t=n.length;--t>=0;)r*=n[t];return r},n.min=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]<r&&(r=n[t]);return r},n.max=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]>r&&(r=n[t]);return r},n.unique=function(n){for(var r={},t=[],e=0;e<n.length;e++)r[n[e]]||(r[n[e]]=!0,t.push(n[e]));return t},n.mean=function(r){return n.sum(r)/r.length},n.meansqerr=function(r){return n.sumsqerr(r)/r.length},n.geomean=function(t){return r.pow(n.product(t),1/t.length)},n.median=function(n){var r=n.length,e=n.slice().sort(t);return 1&r?e[r/2|0]:(e[r/2-1]+e[r/2])/2},n.cumsum=function(r){return n.cumreduce(r,function(n,r){return n+r})},n.cumprod=function(r){return n.cumreduce(r,function(n,r){return n*r})},n.diff=function(n){var r,t=[],e=n.length;for(r=1;r<e;r++)t.push(n[r]-n[r-1]);return t},n.rank=function(n){var r,e=[],o={};for(r=0;r<n.length;r++)o[f=n[r]]?o[f]++:(o[f]=1,e.push(f));var u=e.sort(t),i={},a=1;for(r=0;r<u.length;r++){var f,c=o[f=u[r]],l=(a+(a+c-1))/2;i[f]=l,a+=c}return n.map(function(n){return i[n]})},n.mode=function(n){var r,e=n.length,o=n.slice().sort(t),u=1,i=0,a=0,f=[];for(r=0;r<e;r++)o[r]===o[r+1]?u++:(u>i?(f=[o[r]],i=u,a=0):u===i&&(f.push(o[r]),a++),u=1);return 0===a?f[0]:f},n.range=function(r){return n.max(r)-n.min(r)},n.variance=function(r,t){return n.sumsqerr(r)/(r.length-(t?1:0))},n.pooledvariance=function(r){return r.reduce(function(r,t){return r+n.sumsqerr(t)},0)/(r.reduce(function(n,r){return n+r.length},0)-r.length)},n.deviation=function(r){for(var t=n.mean(r),e=r.length,o=new Array(e),u=0;u<e;u++)o[u]=r[u]-t;return o},n.stdev=function(t,e){return r.sqrt(n.variance(t,e))},n.pooledstdev=function(t){return r.sqrt(n.pooledvariance(t))},n.meandev=function(t){for(var e=n.mean(t),o=[],u=t.length-1;u>=0;u--)o.push(r.abs(t[u]-e));return n.mean(o)},n.meddev=function(t){for(var e=n.median(t),o=[],u=t.length-1;u>=0;u--)o.push(r.abs(t[u]-e));return n.median(o)},n.coeffvar=function(r){return n.stdev(r)/n.mean(r)},n.quartiles=function(n){var e=n.length,o=n.slice().sort(t);return[o[r.round(e/4)-1],o[r.round(e/2)-1],o[r.round(3*e/4)-1]]},n.quantiles=function(n,o,u,i){var a,f,c,l,s,h=n.slice().sort(t),g=[o.length],p=n.length;for(void 0===u&&(u=3/8),void 0===i&&(i=3/8),a=0;a<o.length;a++)s=e((c=p*(f=o[a])+(u+f*(1-u-i)))-(l=r.floor(e(c,1,p-1))),0,1),g[a]=(1-s)*h[l-1]+s*h[l];return g},n.percentile=function(n,r,e){var o=n.slice().sort(t),u=r*(o.length+(e?1:-1))+(e?0:1),i=parseInt(u),a=u-i;return i+1<o.length?o[i-1]+a*(o[i]-o[i-1]):o[i-1]},n.percentileOfScore=function(n,r,t){var e,o,u=0,i=n.length,a=!1;for("strict"===t&&(a=!0),o=0;o<i;o++)e=n[o],(a&&e<r||!a&&e<=r)&&u++;return u/i},n.histogram=function(t,e){e=e||4;var o,u=n.min(t),i=(n.max(t)-u)/e,a=t.length,f=[];for(o=0;o<e;o++)f[o]=0;for(o=0;o<a;o++)f[r.min(r.floor((t[o]-u)/i),e-1)]+=1;return f},n.covariance=function(r,t){var e,o=n.mean(r),u=n.mean(t),i=r.length,a=new Array(i);for(e=0;e<i;e++)a[e]=(r[e]-o)*(t[e]-u);return n.sum(a)/(i-1)},n.corrcoeff=function(r,t){return n.covariance(r,t)/n.stdev(r,1)/n.stdev(t,1)},n.spearmancoeff=function(r,t){return r=n.rank(r),t=n.rank(t),n.corrcoeff(r,t)},n.stanMoment=function(t,e){for(var o=n.mean(t),u=n.stdev(t),i=t.length,a=0,f=0;f<i;f++)a+=r.pow((t[f]-o)/u,e);return a/t.length},n.skewness=function(r){return n.stanMoment(r,3)},n.kurtosis=function(r){return n.stanMoment(r,4)-3};var u=n.prototype;!function(r){for(var t=0;t<r.length;t++)!function(r){u[r]=function(t,e){var i=[],a=0,f=this;if(o(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(f,u[r].call(f,t))}),this;if(this.length>1){for(f=!0===t?this:this.transpose();a<f.length;a++)i[a]=n[r](f[a]);return i}return n[r](this[0],t)}}(r[t])}("cumsum cumprod".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){u[r]=function(t,e){var i=[],a=0,f=this;if(o(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(f,u[r].call(f,t))}),this;if(this.length>1){for("sumrow"!==r&&(f=!0===t?this:this.transpose());a<f.length;a++)i[a]=n[r](f[a]);return!0===t?n[r](n.utils.toVector(i)):i}return n[r](this[0],t)}}(r[t])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){u[r]=function(){
var t,e=[],i=0,a=this,f=Array.prototype.slice.call(arguments);if(o(f[f.length-1])){t=f[f.length-1];var c=f.slice(0,f.length-1);return setTimeout(function(){t.call(a,u[r].apply(a,c))}),this}t=void 0;var l=function(t){return n[r].apply(a,[t].concat(f))};if(this.length>1){for(a=a.transpose();i<a.length;i++)e[i]=l(a[i]);return e}return l(this[0])}}(r[t])}("quantiles percentileOfScore".split(" "))}(n,Math),function(n,r){n.gammaln=function(n){var t,e,o,u=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(o=(e=t=n)+5.5,o-=(t+.5)*r.log(o);u<6;u++)a+=i[u]/++e;return r.log(2.5066282746310007*a/t)-o},n.loggam=function(n){var t,e,o,u,i,a,f,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=n,f=0,1==n||2==n)return 0;for(n<=7&&(t=n+(f=r.floor(7-n))),e=1/(t*t),o=2*r.PI,i=c[9],a=8;a>=0;a--)i*=e,i+=c[a];if(u=i/t+.5*r.log(o)+(t-.5)*r.log(t)-t,n<=7)for(a=1;a<=f;a++)u-=r.log(t-1),t-=1;return u},n.gammafn=function(n){var t,e,o,u,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,l=0,s=0,h=n;if(n>171.6243769536076)return 1/0;if(h<=0){if(!(u=h%1+3.6e-16))return 1/0;f=(1&h?-1:1)*r.PI/r.sin(r.PI*u),h=1-h}for(o=h,e=h<1?h++:(h-=c=(0|h)-1)-1,t=0;t<8;++t)s=(s+i[t])*e,l=l*e+a[t];if(u=s/l+1,o<h)u/=o;else if(o>h)for(t=0;t<c;++t)u*=h,h++;return f&&(u=f/u),u},n.gammap=function(r,t){return n.lowRegGamma(r,t)*n.gammafn(r)},n.lowRegGamma=function(t,e){var o,u=n.gammaln(t),i=t,a=1/t,f=a,c=e+1-t,l=1/1e-30,s=1/c,h=s,g=1,p=-~(8.5*r.log(t>=1?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;g<=p;g++)a+=f*=e/++i;return a*r.exp(-e+t*r.log(e)-u)}for(;g<=p;g++)h*=(s=1/(s=(o=-g*(g-t))*s+(c+=2)))*(l=c+o/l);return 1-h*r.exp(-e+t*r.log(e)-u)},n.factorialln=function(r){return r<0?NaN:n.gammaln(r+1)},n.factorial=function(r){return r<0?NaN:n.gammafn(r+1)},n.combination=function(t,e){return t>170||e>170?r.exp(n.combinationln(t,e)):n.factorial(t)/n.factorial(e)/n.factorial(t-e)},n.combinationln=function(r,t){return n.factorialln(r)-n.factorialln(t)-n.factorialln(r-t)},n.permutation=function(r,t){return n.factorial(r)/n.factorial(r-t)},n.betafn=function(t,e){if(!(t<=0||e<=0))return t+e>170?r.exp(n.betaln(t,e)):n.gammafn(t)*n.gammafn(e)/n.gammafn(t+e)},n.betaln=function(r,t){return n.gammaln(r)+n.gammaln(t)-n.gammaln(r+t)},n.betacf=function(n,t,e){var o,u,i,a,f=1e-30,c=1,l=t+e,s=t+1,h=t-1,g=1,p=1-l*n/s;for(r.abs(p)<f&&(p=f),a=p=1/p;c<=100&&(p=1+(u=c*(e-c)*n/((h+(o=2*c))*(t+o)))*p,r.abs(p)<f&&(p=f),g=1+u/g,r.abs(g)<f&&(g=f),a*=(p=1/p)*g,p=1+(u=-(t+c)*(l+c)*n/((t+o)*(s+o)))*p,r.abs(p)<f&&(p=f),g=1+u/g,r.abs(g)<f&&(g=f),a*=i=(p=1/p)*g,!(r.abs(i-1)<3e-7));c++);return a},n.gammapinv=function(t,e){var o,u,i,a,f,c,l=0,s=e-1,h=1e-8,g=n.gammaln(e);if(t>=1)return r.max(100,e+100*r.sqrt(e));if(t<=0)return 0;for(e>1?(f=r.log(s),c=r.exp(s*(f-1)-g),a=t<.5?t:1-t,o=(2.30753+.27061*(u=r.sqrt(-2*r.log(a))))/(1+u*(.99229+.04481*u))-u,t<.5&&(o=-o),o=r.max(.001,e*r.pow(1-1/(9*e)-o/(3*r.sqrt(e)),3))):o=t<(u=1-e*(.253+.12*e))?r.pow(t/u,1/e):1-r.log(1-(t-u)/(1-u));l<12;l++){if(o<=0)return 0;if((o-=u=(i=(n.lowRegGamma(e,o)-t)/(u=e>1?c*r.exp(-(o-s)+s*(r.log(o)-f)):r.exp(-o+s*r.log(o)-g)))/(1-.5*r.min(1,i*((e-1)/o-1))))<=0&&(o=.5*(o+u)),r.abs(u)<h*o)break}return o},n.erf=function(n){var t,e,o,u,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],a=i.length-1,f=!1,c=0,l=0;for(n<0&&(n=-n,f=!0),e=4*(t=2/(2+n))-2;a>0;a--)o=c,c=e*c-l+i[a],l=o;return u=t*r.exp(-n*n+.5*(i[0]+e*c)-l),f?u-1:1-u},n.erfc=function(r){return 1-n.erf(r)},n.erfcinv=function(t){var e,o,u,i,a=0;if(t>=2)return-100;if(t<=0)return 100;for(i=t<1?t:2-t,e=-.70711*((2.30753+.27061*(u=r.sqrt(-2*r.log(i/2))))/(1+u*(.99229+.04481*u))-u);a<2;a++)e+=(o=n.erfc(e)-i)/(1.1283791670955126*r.exp(-e*e)-e*o);return t<1?e:-e},n.ibetainv=function(t,e,o){var u,i,a,f,c,l,s,h,g,p,v=1e-8,m=e-1,d=o-1,E=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&o>=1?(a=t<.5?t:1-t,l=(2.30753+.27061*(f=r.sqrt(-2*r.log(a))))/(1+f*(.99229+.04481*f))-f,t<.5&&(l=-l),s=(l*l-3)/6,h=2/(1/(2*e-1)+1/(2*o-1)),g=l*r.sqrt(s+h)/h-(1/(2*o-1)-1/(2*e-1))*(s+5/6-2/(3*h)),l=e/(e+o*r.exp(2*g))):(u=r.log(e/(e+o)),i=r.log(o/(e+o)),l=t<(f=r.exp(e*u)/e)/(g=f+(c=r.exp(o*i)/o))?r.pow(e*g*t,1/e):1-r.pow(o*g*(1-t),1/o)),p=-n.gammaln(e)-n.gammaln(o)+n.gammaln(e+o);E<10;E++){if(0===l||1===l)return l;if((l-=f=(c=(n.ibeta(l,e,o)-t)/(f=r.exp(m*r.log(l)+d*r.log(1-l)+p)))/(1-.5*r.min(1,c*(m/l-d/(1-l)))))<=0&&(l=.5*(l+f)),l>=1&&(l=.5*(l+f+1)),r.abs(f)<v*l&&E>0)break}return l},n.ibeta=function(t,e,o){var u=0===t||1===t?0:r.exp(n.gammaln(e+o)-n.gammaln(e)-n.gammaln(o)+e*r.log(t)+o*r.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+o+2)?u*n.betacf(t,e,o)/e:1-u*n.betacf(1-t,o,e)/o)},n.randn=function(t,e){var o,u,i,a,f;if(e||(e=t),t)return n.create(t,e,function(){return n.randn()});do{o=n._random_fn(),u=1.7156*(n._random_fn()-.5),f=(i=o-.449871)*i+(a=r.abs(u)+.386595)*(.196*a-.25472*i)}while(f>.27597&&(f>.27846||u*u>-4*r.log(o)*o*o));return u/o},n.randg=function(t,e,o){var u,i,a,f,c,l,s=t;if(o||(o=e),t||(t=1),e)return(l=n.zeros(e,o)).alter(function(){return n.randg(t)}),l;t<1&&(t+=1),u=t-1/3,i=1/r.sqrt(9*u);do{do{f=1+i*(c=n.randn())}while(f<=0);f*=f*f,a=n._random_fn()}while(a>1-.331*r.pow(c,4)&&r.log(a)>.5*c*c+u*(1-f+r.log(f)));if(t==s)return u*f;do{a=n._random_fn()}while(0===a);return r.pow(a,1/s)*u*f},function(r){for(var t=0;t<r.length;t++)!function(r){n.fn[r]=function(){return n(n.map(this,function(t){return n[r](t)}))}}(r[t])}("gammaln gammafn factorial factorialln".split(" ")),function(r){for(var t=0;t<r.length;t++)!function(r){n.fn[r]=function(){return n(n[r].apply(null,arguments))}}(r[t])}("randn".split(" "))}(n,Math),function(n,r){function t(n,t,e,o){for(var u,i=0,a=1,f=1,c=1,l=0,s=0;r.abs((f-s)/f)>o;)s=f,a=c+(u=-(t+l)*(t+e+l)*n/(t+2*l)/(t+2*l+1))*a,f=(i=f+u*i)+(u=(l+=1)*(e-l)*n/(t+2*l-1)/(t+2*l))*f,i/=c=a+u*c,a/=c,f/=c,c=1;return f/t}function e(n){return n/r.abs(n)}function o(t,e,o){var u=12,i=6,a=-30,f=-50,c=60,l=8,s=3,h=2,g=3,p=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],v=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],m=.5*t;if(m>=l)return 1;var d,E=2*n.normal.cdf(m,0,1,1,0)-1;E=E>=r.exp(f/o)?r.pow(E,o):0;for(var M=m,N=(l-m)/(d=t>s?h:g),w=M+N,I=0,y=o-1,b=1;b<=d;b++){for(var T=0,S=.5*(w+M),A=.5*(w-M),D=1;D<=u;D++){var R,C=S+A*(i<D?p[(R=u-D+1)-1]:-p[(R=D)-1]),x=C*C;if(x>c)break;var O=2*n.normal.cdf(C,0,1,1,0)*.5-2*n.normal.cdf(C,t,1,1,0)*.5;O>=r.exp(a/y)&&(T+=O=v[R-1]*r.exp(-.5*x)*r.pow(O,y))}I+=T*=2*A*o/r.sqrt(2*r.PI),M=w,w+=N}return(E+=I)<=r.exp(a/e)?0:(E=r.pow(E,e))>=1?1:E}function u(n,t,e){var o=.322232421088,u=.099348462606,i=-1,a=.588581570495,f=-.342242088547,c=.531103462366,l=-.204231210125,s=.10353775285,h=-453642210148e-16,g=.0038560700634,p=.8832,v=.2368,m=1.214,d=1.208,E=1.4142,M=120,N=.5-.5*n,w=r.sqrt(r.log(1/(N*N))),I=w+((((w*h+l)*w+f)*w+i)*w+o)/((((w*g+s)*w+c)*w+a)*w+u);e<M&&(I+=(I*I*I+I)/e/4);var y=p-v*I;return e<M&&(y+=-m/e+d*I/e),I*(y*r.log(t-1)+E)}!function(r){for(var t=0;t<r.length;t++)!function(r){n[r]=function t(n,r,e){return this instanceof t?(this._a=n,this._b=r,this._c=e,this):new t(n,r,e)},n.fn[r]=function(t,e,o){var u=n[r](t,e,o);return u.data=this,u},n[r].prototype.sample=function(t){var e=this._a,o=this._b,u=this._c;return t?n.alter(t,function(){return n[r].sample(e,o,u)}):n[r].sample(e,o,u)},function(t){for(var e=0;e<t.length;e++)!function(t){n[r].prototype[t]=function(e){var o=this._a,u=this._b,i=this._c;return e||0===e||(e=this.data),"number"!=typeof e?n.fn.map.call(e,function(e){return n[r][t](e,o,u,i)}):n[r][t](e,o,u,i)}}(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){n[r].prototype[t]=function(){return n[r][t](this._a,this._b,this._c)}}(t[e])}("mean median mode variance".split(" "))}(r[t])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),n.extend(n.beta,{pdf:function(t,e,o){return t>1||t<0?0:1==e&&1==o?1:e<512&&o<512?r.pow(t,e-1)*r.pow(1-t,o-1)/n.betafn(e,o):r.exp((e-1)*r.log(t)+(o-1)*r.log(1-t)-n.betaln(e,o))},cdf:function(r,t,e){return r>1||r<0?1*(r>1):n.ibeta(r,t,e)},inv:function(r,t,e){return n.ibetainv(r,t,e)},mean:function(n,r){return n/(n+r)},median:function(r,t){return n.ibetainv(.5,r,t)},mode:function(n,r){return(n-1)/(n+r-2)},sample:function(r,t){var e=n.randg(r);return e/(e+n.randg(t))},variance:function(n,t){return n*t/(r.pow(n+t,2)*(n+t+1))}}),n.extend(n.centralF,{pdf:function(t,e,o){var u;return t<0?0:e<=2?0===t&&e<2?1/0:0===t&&2===e?1:1/n.betafn(e/2,o/2)*r.pow(e/o,e/2)*r.pow(t,e/2-1)*r.pow(1+e/o*t,-(e+o)/2):(u=e*t/(o+t*e),e*(o/(o+t*e))/2*n.binomial.pdf((e-2)/2,(e+o-2)/2,u))},cdf:function(r,t,e){return r<0?0:n.ibeta(t*r/(t*r+e),t/2,e/2)},inv:function(r,t,e){return e/(t*(1/n.ibetainv(r,t/2,e/2)-1))},mean:function(n,r){return r>2?r/(r-2):void 0},mode:function(n,r){return n>2?r*(n-2)/(n*(r+2)):void 0},sample:function(r,t){return 2*n.randg(r/2)/r/(2*n.randg(t/2)/t)},variance:function(n,r){if(!(r<=4))return 2*r*r*(n+r-2)/(n*(r-2)*(r-2)*(r-4))}}),n.extend(n.cauchy,{pdf:function(n,t,e){return e<0?0:e/(r.pow(n-t,2)+r.pow(e,2))/r.PI},cdf:function(n,t,e){return r.atan((n-t)/e)/r.PI+.5},inv:function(n,t,e){return t+e*r.tan(r.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(t,e){return n.randn()*r.sqrt(1/(2*n.randg(.5)))*e+t}}),n.extend(n.chisquare,{pdf:function(t,e){return t<0?0:0===t&&2===e?.5:r.exp((e/2-1)*r.log(t)-t/2-e/2*r.log(2)-n.gammaln(e/2))},cdf:function(r,t){return r<0?0:n.lowRegGamma(t/2,r/2)},inv:function(r,t){return 2*n.gammapinv(r,.5*t)},mean:function(n){return n},median:function(n){return n*r.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(r){return 2*n.randg(r/2)},variance:function(n){return 2*n}}),n.extend(n.exponential,{pdf:function(n,t){return n<0?0:t*r.exp(-t*n)},cdf:function(n,t){return n<0?0:1-r.exp(-t*n)},inv:function(n,t){return-r.log(1-n)/t},mean:function(n){return 1/n},median:function(n){return 1/n*r.log(2)},mode:function(){return 0},sample:function(t){return-1/t*r.log(n._random_fn())},variance:function(n){return r.pow(n,-2)}}),n.extend(n.gamma,{pdf:function(t,e,o){return t<0?0:0===t&&1===e?1/o:r.exp((e-1)*r.log(t)-t/o-n.gammaln(e)-e*r.log(o))},cdf:function(r,t,e){return r<0?0:n.lowRegGamma(t,r/e)},inv:function(r,t,e){return n.gammapinv(r,t)*e},mean:function(n,r){return n*r},mode:function(n,r){if(n>1)return(n-1)*r},sample:function(r,t){return n.randg(r)*t},variance:function(n,r){return n*r*r}}),n.extend(n.invgamma,{pdf:function(t,e,o){return t<=0?0:r.exp(-(e+1)*r.log(t)-o/t-n.gammaln(e)+e*r.log(o))},cdf:function(r,t,e){return r<=0?0:1-n.lowRegGamma(t,e/r)},inv:function(r,t,e){return e/n.gammapinv(1-r,t)},mean:function(n,r){return n>1?r/(n-1):void 0},mode:function(n,r){return r/(n+1)},sample:function(r,t){return t/n.randg(r)},variance:function(n,r){if(!(n<=2))return r*r/((n-1)*(n-1)*(n-2))}}),n.extend(n.kumaraswamy,{pdf:function(n,t,e){return 0===n&&1===t?e:1===n&&1===e?t:r.exp(r.log(t)+r.log(e)+(t-1)*r.log(n)+(e-1)*r.log(1-r.pow(n,t)))},cdf:function(n,t,e){return n<0?0:n>1?1:1-r.pow(1-r.pow(n,t),e)},inv:function(n,t,e){return r.pow(1-r.pow(1-n,1/e),1/t)},mean:function(r,t){return t*n.gammafn(1+1/r)*n.gammafn(t)/n.gammafn(1+1/r+t)},median:function(n,t){return r.pow(1-r.pow(2,-1/t),1/n)},mode:function(n,t){if(n>=1&&t>=1&&1!==n&&1!==t)return r.pow((n-1)/(n*t-1),1/n)},variance:function(){throw new Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(n,t,e){return n<=0?0:r.exp(-r.log(n)-.5*r.log(2*r.PI)-r.log(e)-r.pow(r.log(n)-t,2)/(2*e*e))},cdf:function(t,e,o){return t<0?0:.5+.5*n.erf((r.log(t)-e)/r.sqrt(2*o*o))},inv:function(t,e,o){return r.exp(-1.4142135623730951*o*n.erfcinv(2*t)+e)},mean:function(n,t){return r.exp(n+t*t/2)},median:function(n){return r.exp(n)},mode:function(n,t){return r.exp(n-t*t)},sample:function(t,e){return r.exp(n.randn()*e+t)},variance:function(n,t){return(r.exp(t*t)-1)*r.exp(2*n+t*t)}}),n.extend(n.noncentralt,{pdf:function(t,e,o){var u=1e-14;return r.abs(o)<u?n.studentt.pdf(t,e):r.abs(t)<u?r.exp(n.gammaln((e+1)/2)-o*o/2-.5*r.log(r.PI*e)-n.gammaln(e/2)):e/t*(n.noncentralt.cdf(t*r.sqrt(1+2/e),e+2,o)-n.noncentralt.cdf(t,e,o))},cdf:function(t,e,o){var u=1e-14,i=200;if(r.abs(o)<u)return n.studentt.cdf(t,e);var a=!1;t<0&&(a=!0,o=-o);for(var f=n.normal.cdf(-o,0,1),c=u+1,l=c,s=t*t/(t*t+e),h=0,g=r.exp(-o*o/2),p=r.exp(-o*o/2-.5*r.log(2)-n.gammaln(1.5))*o;h<i||l>u||c>u;)l=c,h>0&&(g*=o*o/(2*h),p*=o*o/(2*(h+.5))),f+=.5*(c=g*n.beta.cdf(s,h+.5,e/2)+p*n.beta.cdf(s,h+1,e/2)),h++;return a?1-f:f}}),n.extend(n.normal,{pdf:function(n,t,e){return r.exp(-.5*r.log(2*r.PI)-r.log(e)-r.pow(n-t,2)/(2*e*e))},cdf:function(t,e,o){return.5*(1+n.erf((t-e)/r.sqrt(2*o*o)))},inv:function(r,t,e){return-1.4142135623730951*e*n.erfcinv(2*r)+t},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(r,t){return n.randn()*t+r},variance:function(n,r){return r*r}}),n.extend(n.pareto,{pdf:function(n,t,e){return n<t?0:e*r.pow(t,e)/r.pow(n,e+1)},cdf:function(n,t,e){return n<t?0:1-r.pow(t/n,e)},inv:function(n,t,e){return t/r.pow(1-n,1/e)},mean:function(n,t){if(!(t<=1))return t*r.pow(n,t)/(t-1)},median:function(n,t){return n*(t*r.SQRT2)},mode:function(n){return n},variance:function(n,t){if(!(t<=2))return n*n*t/(r.pow(t-1,2)*(t-2))}}),n.extend(n.studentt,{pdf:function(t,e){return e=e>1e100?1e100:e,1/(r.sqrt(e)*n.betafn(.5,e/2))*r.pow(1+t*t/e,-(e+1)/2)},cdf:function(t,e){var o=e/2;return n.ibeta((t+r.sqrt(t*t+e))/(2*r.sqrt(t*t+e)),o,o)},inv:function(t,e){var o=n.ibetainv(2*r.min(t,1-t),.5*e,.5);return o=r.sqrt(e*(1-o)/o),t>.5?o:-o},mean:function(n){return n>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return n.randn()*r.sqrt(t/(2*n.randg(t/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(n,t,e){return n<0||t<0||e<0?0:e/t*r.pow(n/t,e-1)*r.exp(-r.pow(n/t,e))},cdf:function(n,t,e){return n<0?0:1-r.exp(-r.pow(n/t,e))},inv:function(n,t,e){return t*r.pow(-r.log(1-n),1/e)},mean:function(r,t){return r*n.gammafn(1+1/t)},median:function(n,t){return n*r.pow(r.log(2),1/t)},mode:function(n,t){return t<=1?0:n*r.pow((t-1)/t,1/t)},sample:function(t,e){return t*r.pow(-r.log(n._random_fn()),1/e)},variance:function(t,e){return t*t*n.gammafn(1+2/e)-r.pow(n.weibull.mean(t,e),2)}}),n.extend(n.uniform,{pdf:function(n,r,t){return n<r||n>t?0:1/(t-r)},cdf:function(n,r,t){return n<r?0:n<t?(n-r)/(t-r):1},inv:function(n,r,t){return r+n*(t-r)},mean:function(n,r){return.5*(n+r)},median:function(r,t){return n.mean(r,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,t){return r/2+t/2+(t/2-r/2)*(2*n._random_fn()-1)},variance:function(n,t){return r.pow(t-n,2)/12}}),n.extend(n.binomial,{pdf:function(t,e,o){return 0===o||1===o?e*o===t?1:0:n.combination(e,t)*r.pow(o,t)*r.pow(1-o,e-t)},cdf:function(e,o,u){var i,a=1e-10;if(e<0)return 0;if(e>=o)return 1;if(u<0||u>1||o<=0)return NaN;var f=u,c=(e=r.floor(e))+1,l=o-e,s=c+l,h=r.exp(n.gammaln(s)-n.gammaln(l)-n.gammaln(c)+c*r.log(f)+l*r.log(1-f));return i=f<(c+1)/(s+2)?h*t(f,c,l,a):1-h*t(1-f,l,c,a),r.round(1/a*(1-i))/(1/a)}}),n.extend(n.negbin,{pdf:function(t,e,o){return t===t>>>0&&(t<0?0:n.combination(t+e-1,e-1)*r.pow(1-o,t)*r.pow(o,e))},cdf:function(r,t,e){var o=0,u=0;if(r<0)return 0;for(;u<=r;u++)o+=n.negbin.pdf(u,t,e);return o}}),n.extend(n.hypgeom,{pdf:function(t,e,o,u){if(t!=t|0)return!1;if(t<0||t<o-(e-u))return 0;if(t>u||t>o)return 0;if(2*o>e)return 2*u>e?n.hypgeom.pdf(e-o-u+t,e,e-o,e-u):n.hypgeom.pdf(u-t,e,e-o,u);if(2*u>e)return n.hypgeom.pdf(o-t,e,o,e-u);if(o<u)return n.hypgeom.pdf(t,e,u,o);for(var i=1,a=0,f=0;f<t;f++){for(;i>1&&a<u;)i*=1-o/(e-a),a++;i*=(u-f)*(o-f)/((f+1)*(e-o-u+f+1))}for(;a<u;a++)i*=1-o/(e-a);return r.min(1,r.max(0,i))},cdf:function(t,e,o,u){if(t<0||t<o-(e-u))return 0;if(t>=u||t>=o)return 1;if(2*o>e)return 2*u>e?n.hypgeom.cdf(e-o-u+t,e,e-o,e-u):1-n.hypgeom.cdf(u-t-1,e,e-o,u);if(2*u>e)return 1-n.hypgeom.cdf(o-t-1,e,o,e-u);if(o<u)return n.hypgeom.cdf(t,e,u,o);for(var i=1,a=1,f=0,c=0;c<t;c++){for(;i>1&&f<u;){var l=1-o/(e-f);a*=l,i*=l,f++}i+=a*=(u-c)*(o-c)/((c+1)*(e-o-u+c+1))}for(;f<u;f++)i*=1-o/(e-f);return r.min(1,r.max(0,i))}}),n.extend(n.poisson,{pdf:function(t,e){return e<0||t%1!=0||t<0?0:r.pow(e,t)*r.exp(-e)/n.factorial(t)},cdf:function(r,t){var e=[],o=0;if(r<0)return 0;for(;o<=r;o++)e.push(n.poisson.pdf(o,t));return n.sum(e)},mean:function(n){return n},variance:function(n){return n},sampleSmall:function(t){var e=1,o=0,u=r.exp(-t);do{o++,e*=n._random_fn()}while(e>u);return o-1},sampleLarge:function(t){var e,o,u,i,a,f,c,l,s,h,g=t;for(i=r.sqrt(g),a=r.log(g),f=.02483*(c=.931+2.53*i)-.059,l=1.1239+1.1328/(c-3.4),s=.9277-3.6224/(c-2);;){if(o=r.random()-.5,u=r.random(),h=.5-r.abs(o),e=r.floor((2*f/h+c)*o+g+.43),h>=.07&&u<=s)return e;if(!(e<0||h<.013&&u>h)&&r.log(u)+r.log(l)-r.log(f/(h*h)+c)<=e*a-g-n.loggam(e+1))return e}},sample:function(n){return n<10?this.sampleSmall(n):this.sampleLarge(n)}}),n.extend(n.triangular,{pdf:function(n,r,t,e){return t<=r||e<r||e>t?NaN:n<r||n>t?0:n<e?2*(n-r)/((t-r)*(e-r)):n===e?2/(t-r):2*(t-n)/((t-r)*(t-e))},cdf:function(n,t,e,o){return e<=t||o<t||o>e?NaN:n<=t?0:n>=e?1:n<=o?r.pow(n-t,2)/((e-t)*(o-t)):1-r.pow(e-n,2)/((e-t)*(e-o))},inv:function(n,t,e,o){return e<=t||o<t||o>e?NaN:n<=(o-t)/(e-t)?t+(e-t)*r.sqrt(n*((o-t)/(e-t))):t+(e-t)*(1-r.sqrt((1-n)*(1-(o-t)/(e-t))))},mean:function(n,r,t){return(n+r+t)/3},median:function(n,t,e){return e<=(n+t)/2?t-r.sqrt((t-n)*(t-e))/r.sqrt(2):e>(n+t)/2?n+r.sqrt((t-n)*(e-n))/r.sqrt(2):void 0},mode:function(n,r,t){return t},sample:function(t,e,o){var u=n._random_fn();return u<(o-t)/(e-t)?t+r.sqrt(u*(e-t)*(o-t)):e-r.sqrt((1-u)*(e-t)*(e-o))},variance:function(n,r,t){return(n*n+r*r+t*t-n*r-n*t-r*t)/18}}),n.extend(n.arcsine,{pdf:function(n,t,e){return e<=t?NaN:n<=t||n>=e?0:2/r.PI*r.pow(r.pow(e-t,2)-r.pow(2*n-t-e,2),-.5)},cdf:function(n,t,e){return n<t?0:n<e?2/r.PI*r.asin(r.sqrt((n-t)/(e-t))):1},inv:function(n,t,e){return t+(.5-.5*r.cos(r.PI*n))*(e-t)},mean:function(n,r){return r<=n?NaN:(n+r)/2},median:function(n,r){return r<=n?NaN:(n+r)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return(t+e)/2+(e-t)/2*r.sin(2*r.PI*n.uniform.sample(0,1))},variance:function(n,t){return t<=n?NaN:r.pow(t-n,2)/8}}),n.extend(n.laplace,{pdf:function(n,t,e){return e<=0?0:r.exp(-r.abs(n-t)/e)/(2*e)},cdf:function(n,t,e){return e<=0?0:n<t?.5*r.exp((n-t)/e):1-.5*r.exp(-(n-t)/e)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,r){return 2*r*r},sample:function(t,o){var u=n._random_fn()-.5;return t-o*e(u)*r.log(1-2*r.abs(u))}}),n.extend(n.tukey,{cdf:function(t,e,u){var i=1,a=e,f=16,c=8,l=-30,s=1e-14,h=100,g=800,p=5e3,v=25e3,m=1,d=.5,E=.25,M=.125,N=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],w=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(u<2||i<1||a<2)return NaN;if(!Number.isFinite(t))return 1;if(u>v)return o(t,i,a);var I,y=.5*u,b=y*r.log(u)-u*r.log(2)-n.gammaln(y),T=y-1,S=.25*u;I=u<=h?m:u<=g?d:u<=p?E:M,b+=r.log(I);for(var A=0,D=1;D<=50;D++){for(var R=0,C=(2*D-1)*I,x=1;x<=f;x++){var O,P;c<x?(O=x-c-1,P=b+T*r.log(C+N[O]*I)-(N[O]*I+C)*S):(O=x-1,P=b+T*r.log(C-N[O]*I)+(N[O]*I-C)*S),P>=l&&(R+=o(c<x?t*r.sqrt(.5*(N[O]*I+C)):t*r.sqrt(.5*(-N[O]*I+C)),i,a)*w[O]*r.exp(P))}if(D*I>=1&&R<=s)break;A+=R}if(R>s)throw new Error("tukey.cdf failed to converge");return A>1&&(A=1),A},inv:function(t,e,o){var i=1e-4,a=50;if(o<2||e<2)return NaN;if(t<0||t>1)return NaN;if(0===t)return 0;if(1===t)return 1/0;var f,c=u(t,e,o),l=n.tukey.cdf(c,e,o)-t;f=l>0?r.max(0,c-1):c+1;for(var s,h=n.tukey.cdf(f,e,o)-t,g=1;g<a;g++)if(s=f-h*(f-c)/(h-l),l=h,c=f,s<0&&(s=0,h=-t),h=n.tukey.cdf(s,e,o)-t,f=s,r.abs(f-c)<i)return s;throw new Error("tukey.inv failed to converge")}})}(n,Math),function(n,r){function t(r){return o(r)||r instanceof n}var e=Array.prototype.push,o=n.utils.isArray;n.extend({add:function(r,e){return t(e)?(t(e[0])||(e=[e]),n.map(r,function(n,r,t){return n+e[r][t]})):n.map(r,function(n){return n+e})},subtract:function(r,e){return t(e)?(t(e[0])||(e=[e]),n.map(r,function(n,r,t){return n-e[r][t]||0})):n.map(r,function(n){return n-e})},divide:function(r,e){return t(e)?(t(e[0])||(e=[e]),n.multiply(r,n.inv(e))):n.map(r,function(n){return n/e})},multiply:function(r,e){var o,u,i,a,f,c,l,s;if(void 0===r.length&&void 0===e.length)return r*e;if(f=r.length,c=r[0].length,l=n.zeros(f,i=t(e)?e[0].length:c),s=0,t(e)){for(;s<i;s++)for(o=0;o<f;o++){for(a=0,u=0;u<c;u++)a+=r[o][u]*e[u][s];l[o][s]=a}return 1===f&&1===s?l[0][0]:l}return n.map(r,function(n){return n*e})},outer:function(r,t){return n.multiply(r.map(function(n){return[n]}),[t])},dot:function(r,e){t(r[0])||(r=[r]),t(e[0])||(e=[e]);for(var o,u,i=1===r[0].length&&1!==r.length?n.transpose(r):r,a=1===e[0].length&&1!==e.length?n.transpose(e):e,f=[],c=0,l=i.length,s=i[0].length;c<l;c++){for(f[c]=[],o=0,u=0;u<s;u++)o+=i[c][u]*a[c][u];f[c]=o}return 1===f.length?f[0]:f},pow:function(t,e){return n.map(t,function(n){return r.pow(n,e)})},exp:function(t){return n.map(t,function(n){return r.exp(n)})},log:function(t){return n.map(t,function(n){return r.log(n)})},abs:function(t){return n.map(t,function(n){return r.abs(n)})},norm:function(n,e){var o=0,u=0;for(isNaN(e)&&(e=2),t(n[0])&&(n=n[0]);u<n.length;u++)o+=r.pow(r.abs(n[u]),e);return r.pow(o,1/e)},angle:function(t,e){return r.acos(n.dot(t,e)/(n.norm(t)*n.norm(e)))},aug:function(n,r){var t,o=[];for(t=0;t<n.length;t++)o.push(n[t].slice());for(t=0;t<o.length;t++)e.apply(o[t],r[t]);return o},inv:function(r){for(var t,e=r.length,o=r[0].length,u=n.identity(e,o),i=n.gauss_jordan(r,u),a=[],f=0;f<e;f++)for(a[f]=[],t=o;t<i[0].length;t++)a[f][t-o]=i[f][t];return a},det:function(n){var r,t=n.length,e=2*t,o=new Array(e),u=t-1,i=e-1,a=u-t+1,f=i,c=0,l=0;if(2===t)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;c<e;c++)o[c]=1;for(c=0;c<t;c++){for(r=0;r<t;r++)o[a<0?a+t:a]*=n[c][r],o[f<t?f+t:f]*=n[c][r],a++,f--;a=--u-t+1,f=--i}for(c=0;c<t;c++)l+=o[c];for(;c<e;c++)l-=o[c];return l},gauss_elimination:function(t,e){var o,u,i,a,f=0,c=0,l=t.length,s=t[0].length,h=1,g=0,p=[];for(o=(t=n.aug(t,e))[0].length,f=0;f<l;f++){for(u=t[f][f],c=f,a=f+1;a<s;a++)u<r.abs(t[a][f])&&(u=t[a][f],c=a);if(c!=f)for(a=0;a<o;a++)i=t[f][a],t[f][a]=t[c][a],t[c][a]=i;for(c=f+1;c<l;c++)for(h=t[c][f]/t[f][f],a=f;a<o;a++)t[c][a]=t[c][a]-h*t[f][a]}for(f=l-1;f>=0;f--){for(g=0,c=f+1;c<=l-1;c++)g+=p[c]*t[f][c];p[f]=(t[f][o-1]-g)/t[f][f]}return p},gauss_jordan:function(t,e){var o,u,i,a=n.aug(t,e),f=a.length,c=a[0].length,l=0;for(u=0;u<f;u++){var s=u;for(i=u+1;i<f;i++)r.abs(a[i][u])>r.abs(a[s][u])&&(s=i);var h=a[u];for(a[u]=a[s],a[s]=h,i=u+1;i<f;i++)for(l=a[i][u]/a[u][u],o=u;o<c;o++)a[i][o]-=a[u][o]*l}for(u=f-1;u>=0;u--){for(l=a[u][u],i=0;i<u;i++)for(o=c-1;o>u-1;o--)a[i][o]-=a[u][o]*a[i][u]/l;for(a[u][u]/=l,o=f;o<c;o++)a[u][o]/=l}return a},triaUpSolve:function(r,t){var e,o=r[0].length,u=n.zeros(1,o)[0],i=!1;return null!=t[0].length&&(t=t.map(function(n){return n[0]}),i=!0),n.arange(o-1,-1,-1).forEach(function(i){e=n.arange(i+1,o).map(function(n){return u[n]*r[i][n]}),u[i]=(t[i]-n.sum(e))/r[i][i]}),i?u.map(function(n){return[n]}):u},triaLowSolve:function(r,t){var e,o=r[0].length,u=n.zeros(1,o)[0],i=!1;return null!=t[0].length&&(t=t.map(function(n){return n[0]}),i=!0),n.arange(o).forEach(function(o){e=n.arange(o).map(function(n){return r[o][n]*u[n]}),u[o]=(t[o]-n.sum(e))/r[o][o]}),i?u.map(function(n){return[n]}):u},lu:function(r){var t,e=r.length,o=n.identity(e),u=n.zeros(r.length,r[0].length);return n.arange(e).forEach(function(n){u[0][n]=r[0][n]}),n.arange(1,e).forEach(function(i){n.arange(i).forEach(function(e){t=n.arange(e).map(function(n){return o[i][n]*u[n][e]}),o[i][e]=(r[i][e]-n.sum(t))/u[e][e]}),n.arange(i,e).forEach(function(e){t=n.arange(i).map(function(n){return o[i][n]*u[n][e]}),u[i][e]=r[t.length][e]-n.sum(t)})}),[o,u]},cholesky:function(t){var e,o=t.length,u=n.zeros(t.length,t[0].length);return n.arange(o).forEach(function(i){e=n.arange(i).map(function(n){return r.pow(u[i][n],2)}),u[i][i]=r.sqrt(t[i][i]-n.sum(e)),n.arange(i+1,o).forEach(function(r){e=n.arange(i).map(function(n){return u[i][n]*u[r][n]}),u[r][i]=(t[i][r]-n.sum(e))/u[i][i]})}),u},gauss_jacobi:function(t,e,o,u){for(var i,a,f,c,l=0,s=0,h=t.length,g=[],p=[],v=[];l<h;l++)for(g[l]=[],p[l]=[],v[l]=[],s=0;s<h;s++)l>s?(g[l][s]=t[l][s],p[l][s]=v[l][s]=0):l<s?(p[l][s]=t[l][s],g[l][s]=v[l][s]=0):(v[l][s]=t[l][s],g[l][s]=p[l][s]=0);for(f=n.multiply(n.multiply(n.inv(v),n.add(g,p)),-1),a=n.multiply(n.inv(v),e),i=o,c=n.add(n.multiply(f,o),a),l=2;r.abs(n.norm(n.subtract(c,i)))>u;)i=c,c=n.add(n.multiply(f,i),a),l++;return c},gauss_seidel:function(t,e,o,u){for(var i,a,f,c,l,s=0,h=t.length,g=[],p=[],v=[];s<h;s++)for(g[s]=[],p[s]=[],v[s]=[],i=0;i<h;i++)s>i?(g[s][i]=t[s][i],p[s][i]=v[s][i]=0):s<i?(p[s][i]=t[s][i],g[s][i]=v[s][i]=0):(v[s][i]=t[s][i],g[s][i]=p[s][i]=0);for(c=n.multiply(n.multiply(n.inv(n.add(v,g)),p),-1),f=n.multiply(n.inv(n.add(v,g)),e),a=o,l=n.add(n.multiply(c,o),f),s=2;r.abs(n.norm(n.subtract(l,a)))>u;)a=l,l=n.add(n.multiply(c,a),f),s+=1;return l},SOR:function(t,e,o,u,i){for(var a,f,c,l,s,h=0,g=t.length,p=[],v=[],m=[];h<g;h++)for(p[h]=[],v[h]=[],m[h]=[],a=0;a<g;a++)h>a?(p[h][a]=t[h][a],v[h][a]=m[h][a]=0):h<a?(v[h][a]=t[h][a],p[h][a]=m[h][a]=0):(m[h][a]=t[h][a],p[h][a]=v[h][a]=0);for(l=n.multiply(n.inv(n.add(m,n.multiply(p,i))),n.subtract(n.multiply(m,1-i),n.multiply(v,i))),c=n.multiply(n.multiply(n.inv(n.add(m,n.multiply(p,i))),e),i),f=o,s=n.add(n.multiply(l,o),c),h=2;r.abs(n.norm(n.subtract(s,f)))>u;)f=s,s=n.add(n.multiply(l,f),c),h++;return s},householder:function(t){for(var e,o,u,i,a=t.length,f=t[0].length,c=0,l=[],s=[];c<a-1;c++){for(e=0,i=c+1;i<f;i++)e+=t[i][c]*t[i][c];for(e=(t[c+1][c]>0?-1:1)*r.sqrt(e),o=r.sqrt((e*e-t[c+1][c]*e)/2),(l=n.zeros(a,1))[c+1][0]=(t[c+1][c]-e)/(2*o),u=c+2;u<a;u++)l[u][0]=t[u][c]/(2*o);s=n.subtract(n.identity(a,f),n.multiply(n.multiply(l,n.transpose(l)),2)),t=n.multiply(s,n.multiply(t,s))}return t},QR:function(){function t(t){var u,i,a,f=t.length,c=t[0].length,l=n.zeros(c,c);for(t=n.copy(t),i=0;i<c;i++){for(l[i][i]=r.sqrt(e(o(f).map(function(n){return t[n][i]*t[n][i]}))),u=0;u<f;u++)t[u][i]=t[u][i]/l[i][i];for(a=i+1;a<c;a++)for(l[i][a]=e(o(f).map(function(n){return t[n][i]*t[n][a]})),u=0;u<f;u++)t[u][a]=t[u][a]-t[u][i]*l[i][a]}return[t,l]}var e=n.sum,o=n.arange;return t}(),lstsq:function(){function r(r){var t=(r=n.copy(r)).length,e=n.identity(t);return n.arange(t-1,-1,-1).forEach(function(t){n.sliceAssign(e,{row:t},n.divide(n.slice(e,{row:t}),r[t][t])),n.sliceAssign(r,{row:t},n.divide(n.slice(r,{row:t}),r[t][t])),n.arange(t).forEach(function(o){var u=n.multiply(r[o][t],-1),i=n.slice(r,{row:o}),a=n.multiply(n.slice(r,{row:t}),u);n.sliceAssign(r,{row:o},n.add(i,a));var f=n.slice(e,{row:o}),c=n.multiply(n.slice(e,{row:t}),u);n.sliceAssign(e,{row:o},n.add(f,c))})}),e}function t(t,e){var o=!1;void 0===e[0].length&&(e=e.map(function(n){return[n]}),o=!0);var u=n.QR(t),i=u[0],a=u[1],f=t[0].length,c=n.slice(i,{col:{end:f}}),l=r(n.slice(a,{row:{end:f}})),s=n.transpose(c);void 0===s[0].length&&(s=[s]);var h=n.multiply(n.multiply(l,s),e);return void 0===h.length&&(h=[[h]]),o?h.map(function(n){return n[0]}):h}return t}(),jacobi:function(t){for(var e,o,u,i,a,f,c,l=1,s=t.length,h=n.identity(s,s),g=[];1===l;){for(a=t[0][1],u=0,i=1,e=0;e<s;e++)for(o=0;o<s;o++)e!=o&&a<r.abs(t[e][o])&&(a=r.abs(t[e][o]),u=e,i=o);for(f=t[u][u]===t[i][i]?t[u][i]>0?r.PI/4:-r.PI/4:r.atan(2*t[u][i]/(t[u][u]-t[i][i]))/2,(c=n.identity(s,s))[u][u]=r.cos(f),c[u][i]=-r.sin(f),c[i][u]=r.sin(f),c[i][i]=r.cos(f),h=n.multiply(h,c),t=n.multiply(n.multiply(n.inv(c),t),c),l=0,e=1;e<s;e++)for(o=1;o<s;o++)e!=o&&r.abs(t[e][o])>.001&&(l=1)}for(e=0;e<s;e++)g.push(t[e][e]);return[h,g]},rungekutta:function(n,r,t,e,o,u){var i,a,f;if(2===u)for(;e<=t;)o+=((i=r*n(e,o))+(a=r*n(e+r,o+i)))/2,e+=r;if(4===u)for(;e<=t;)o+=((i=r*n(e,o))+2*(a=r*n(e+r/2,o+i/2))+2*(f=r*n(e+r/2,o+a/2))+r*n(e+r,o+f))/6,e+=r;return o},romberg:function(n,t,e,o){for(var u,i,a,f,c,l=0,s=(e-t)/2,h=[],g=[],p=[];l<o/2;){for(c=n(t),a=t,f=0;a<=e;a+=s,f++)h[f]=a;for(u=h.length,a=1;a<u-1;a++)c+=(a%2!=0?4:2)*n(h[a]);c=s/3*(c+n(e)),p[l]=c,s/=2,l++}for(i=p.length,u=1;1!==i;){for(a=0;a<i-1;a++)g[a]=(r.pow(4,u)*p[a+1]-p[a])/(r.pow(4,u)-1);i=g.length,p=g,g=[],u++}return p},richardson:function(n,t,e,o){function u(n,r){for(var t,e=0,o=n.length;e<o;e++)n[e]===r&&(t=e);return t}for(var i,a,f,c,l,s=r.abs(e-n[u(n,e)+1]),h=0,g=[],p=[];o>=s;)i=u(n,e+o),a=u(n,e),g[h]=(t[i]-2*t[a]+t[2*a-i])/(o*o),o/=2,h++;for(c=g.length,f=1;1!=c;){for(l=0;l<c-1;l++)p[l]=(r.pow(4,f)*g[l+1]-g[l])/(r.pow(4,f)-1);c=p.length,g=p,p=[],f++}return g},simpson:function(n,r,t,e){for(var o,u=(t-r)/e,i=n(r),a=[],f=r,c=0,l=1;f<=t;f+=u,c++)a[c]=f;for(o=a.length;l<o-1;l++)i+=(l%2!=0?4:2)*n(a[l]);return u/3*(i+n(t))},hermite:function(n,r,t,e){for(var o,u=n.length,i=0,a=0,f=[],c=[],l=[],s=[];a<u;a++){for(f[a]=1,o=0;o<u;o++)a!=o&&(f[a]*=(e-n[o])/(n[a]-n[o]));for(c[a]=0,o=0;o<u;o++)a!=o&&(c[a]+=1/(n[a]-n[o]));l[a]=(1-2*(e-n[a])*c[a])*(f[a]*f[a]),s[a]=(e-n[a])*(f[a]*f[a]),i+=l[a]*r[a]+s[a]*t[a]}return i},lagrange:function(n,r,t){for(var e,o,u=0,i=0,a=n.length;i<a;i++){for(o=r[i],e=0;e<a;e++)i!=e&&(o*=(t-n[e])/(n[i]-n[e]));u+=o}return u},cubic_spline:function(r,t,e){for(var o,u=r.length,i=0,a=[],f=[],c=[],l=[],s=[],h=[],g=[];i<u-1;i++)s[i]=r[i+1]-r[i];for(c[0]=0,i=1;i<u-1;i++)c[i]=3/s[i]*(t[i+1]-t[i])-3/s[i-1]*(t[i]-t[i-1]);for(i=1;i<u-1;i++)a[i]=[],f[i]=[],a[i][i-1]=s[i-1],a[i][i]=2*(s[i-1]+s[i]),a[i][i+1]=s[i],f[i][0]=c[i];for(l=n.multiply(n.inv(a),f),o=0;o<u-1;o++)h[o]=(t[o+1]-t[o])/s[o]-s[o]*(l[o+1][0]+2*l[o][0])/3,g[o]=(l[o+1][0]-l[o][0])/(3*s[o]);for(o=0;o<u&&!(r[o]>e);o++);return t[o-=1]+(e-r[o])*h[o]+n.sq(e-r[o])*l[o]+(e-r[o])*n.sq(e-r[o])*g[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(r){var t,e,o=r.length,u=r[0].length,i=0,a=[],f=[],c=[],l=[],s=[],h=[],g=[],p=[],v=[],m=[];for(i=0;i<o;i++)a[i]=n.sum(r[i])/u;for(i=0;i<u;i++)for(g[i]=[],t=0;t<o;t++)g[i][t]=r[t][i]-a[t];for(g=n.transpose(g),i=0;i<o;i++)for(p[i]=[],t=0;t<o;t++)p[i][t]=n.dot([g[i]],[g[t]])/(u-1);for(v=(c=n.jacobi(p))[0],f=c[1],m=n.transpose(v),i=0;i<f.length;i++)for(t=i;t<f.length;t++)f[i]<f[t]&&(e=f[i],f[i]=f[t],f[t]=e,l=m[i],m[i]=m[t],m[t]=l);for(h=n.transpose(g),i=0;i<o;i++)for(s[i]=[],t=0;t<h.length;t++)s[i][t]=n.dot([m[i]],[h[t]]);return[r,f,m,s]}}),function(r){for(var t=0;t<r.length;t++)!function(r){n.fn[r]=function(t,e){var o=this;return e?(setTimeout(function(){e.call(o,n.fn[r].call(o,t))},15),this):"number"==typeof n[r](this,t)?n[r](this,t):n(n[r](this,t))}}(r[t])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(n,r){function t(n,t,e,o){if(n>1||e>1||n<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var u=(n*t+e*o)/(t+o);return(n-e)/r.sqrt(u*(1-u)*(1/t+1/o))}var e=[].slice,o=n.utils.isNumber,u=n.utils.isArray;n.extend({zscore:function(){var r=e.call(arguments);return o(r[1])?(r[0]-r[1])/r[2]:(r[0]-n.mean(r[1]))/n.stdev(r[1],r[2])},ztest:function(){var t,o=e.call(arguments);return u(o[1])?(t=n.zscore(o[0],o[1],o[3]),1===o[2]?n.normal.cdf(-r.abs(t),0,1):2*n.normal.cdf(-r.abs(t),0,1)):o.length>2?(t=n.zscore(o[0],o[1],o[2]),1===o[3]?n.normal.cdf(-r.abs(t),0,1):2*n.normal.cdf(-r.abs(t),0,1)):(t=o[0],1===o[1]?n.normal.cdf(-r.abs(t),0,1):2*n.normal.cdf(-r.abs(t),0,1))}}),n.extend(n.fn,{zscore:function(n,r){return(n-this.mean())/this.stdev(r)},ztest:function(t,e,o){var u=r.abs(this.zscore(t,o))
;return 1===e?n.normal.cdf(-u,0,1):2*n.normal.cdf(-u,0,1)}}),n.extend({tscore:function(){var t=e.call(arguments);return 4===t.length?(t[0]-t[1])/(t[2]/r.sqrt(t[3])):(t[0]-n.mean(t[1]))/(n.stdev(t[1],!0)/r.sqrt(t[1].length))},ttest:function(){var t,u=e.call(arguments);return 5===u.length?(t=r.abs(n.tscore(u[0],u[1],u[2],u[3])),1===u[4]?n.studentt.cdf(-t,u[3]-1):2*n.studentt.cdf(-t,u[3]-1)):o(u[1])?(t=r.abs(u[0]),1==u[2]?n.studentt.cdf(-t,u[1]-1):2*n.studentt.cdf(-t,u[1]-1)):(t=r.abs(n.tscore(u[0],u[1])),1==u[2]?n.studentt.cdf(-t,u[1].length-1):2*n.studentt.cdf(-t,u[1].length-1))}}),n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/r.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-n.studentt.cdf(r.abs(this.tscore(t)),this.cols()-1):2*n.studentt.cdf(-r.abs(this.tscore(t)),this.cols()-1)}}),n.extend({anovafscore:function(){var t,o,u,i,a,f,c,l,s=e.call(arguments);if(1===s.length){for(a=new Array(s[0].length),c=0;c<s[0].length;c++)a[c]=s[0][c];s=a}for(o=new Array,c=0;c<s.length;c++)o=o.concat(s[c]);for(u=n.mean(o),t=0,c=0;c<s.length;c++)t+=s[c].length*r.pow(n.mean(s[c])-u,2);for(t/=s.length-1,f=0,c=0;c<s.length;c++)for(i=n.mean(s[c]),l=0;l<s[c].length;l++)f+=r.pow(s[c][l]-i,2);return t/(f/(o.length-s.length))},anovaftest:function(){var r,t,u,i,a=e.call(arguments);if(o(a[0]))return 1-n.centralF.cdf(a[0],a[1],a[2]);var f=n.anovafscore(a);for(r=a.length-1,u=0,i=0;i<a.length;i++)u+=a[i].length;return t=u-r-1,1-n.centralF.cdf(f,r,t)},ftest:function(r,t,e){return 1-n.centralF.cdf(r,t,e)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var r,t=0;for(r=0;r<this.length;r++)t+=this[r].length;return n.ftest(this.anovafscore(),this.length-1,t-this.length)}}),n.extend({qscore:function(){var t,u,i,a,f,c=e.call(arguments);return o(c[0])?(t=c[0],u=c[1],i=c[2],a=c[3],f=c[4]):(t=n.mean(c[0]),u=n.mean(c[1]),i=c[0].length,a=c[1].length,f=c[2]),r.abs(t-u)/(f*r.sqrt((1/i+1/a)/2))},qtest:function(){var r,t=e.call(arguments);3===t.length?(r=t[0],t=t.slice(1)):7===t.length?(r=n.qscore(t[0],t[1],t[2],t[3],t[4]),t=t.slice(5)):(r=n.qscore(t[0],t[1],t[2]),t=t.slice(3));var o=t[0],u=t[1];return 1-n.tukey.cdf(r,u,o-u)},tukeyhsd:function(r){for(var t=n.pooledstdev(r),e=r.map(function(r){return n.mean(r)}),o=r.reduce(function(n,r){return n+r.length},0),u=[],i=0;i<r.length;++i)for(var a=i+1;a<r.length;++a){var f=n.qtest(e[i],e[a],r[i].length,r[a].length,t,o,r.length);u.push([[i,a],f])}return u}}),n.extend({normalci:function(){var t,o=e.call(arguments),u=new Array(2);return t=4===o.length?r.abs(n.normal.inv(o[1]/2,0,1)*o[2]/r.sqrt(o[3])):r.abs(n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/r.sqrt(o[2].length)),u[0]=o[0]-t,u[1]=o[0]+t,u},tci:function(){var t,o=e.call(arguments),u=new Array(2);return t=4===o.length?r.abs(n.studentt.inv(o[1]/2,o[3]-1)*o[2]/r.sqrt(o[3])):r.abs(n.studentt.inv(o[1]/2,o[2].length-1)*n.stdev(o[2],!0)/r.sqrt(o[2].length)),u[0]=o[0]-t,u[1]=o[0]+t,u},significant:function(n,r){return n<r}}),n.extend(n.fn,{normalci:function(r,t){return n.normalci(r,t,this.toArray())},tci:function(r,t){return n.tci(r,t,this.toArray())}}),n.extend(n.fn,{oneSidedDifferenceOfProportions:function(r,e,o,u){var i=t(r,e,o,u);return n.ztest(i,1)},twoSidedDifferenceOfProportions:function(r,e,o,u){var i=t(r,e,o,u);return n.ztest(i,2)}})}(n,Math),n.models=function(){function r(r){var e=r[0].length;return n.arange(e).map(function(o){var u=n.arange(e).filter(function(n){return n!==o});return t(n.col(r,o).map(function(n){return n[0]}),n.col(r,u))})}function t(r,t){var e=r.length,o=t[0].length-1,u=e-o-1,i=n.lstsq(t,r),a=n.multiply(t,i.map(function(n){return[n]})).map(function(n){return n[0]}),f=n.subtract(r,a),c=n.mean(r),l=n.sum(a.map(function(n){return Math.pow(n-c,2)})),s=n.sum(r.map(function(n,r){return Math.pow(n-a[r],2)})),h=l+s;return{exog:t,endog:r,nobs:e,df_model:o,df_resid:u,coef:i,predict:a,resid:f,ybar:c,SST:h,SSE:l,SSR:s,R2:l/h}}function e(t){var e=r(t.exog),o=Math.sqrt(t.SSR/t.df_resid),u=e.map(function(n){var r=n.SST,t=n.R2;return o/Math.sqrt(r*(1-t))}),i=t.coef.map(function(n,r){return(n-0)/u[r]}),a=i.map(function(r){var e=n.studentt.cdf(r,t.df_resid);return 2*(e>.5?1-e:e)}),f=n.studentt.inv(.975,t.df_resid),c=t.coef.map(function(n,r){var t=f*u[r];return[n-t,n+t]});return{se:u,t:i,p:a,sigmaHat:o,interval95:c}}function o(r){var t,e,o,u=r.R2/r.df_model/((1-r.R2)/r.df_resid);return{F_statistic:u,pvalue:1-(t=u,e=r.df_model,o=r.df_resid,n.beta.cdf(t/(o/e+t),e/2,o/2))}}function u(n,r){var u=t(n,r),i=e(u),a=o(u),f=1-(1-u.R2)*((u.nobs-1)/u.df_resid);return u.t=i,u.f=a,u.adjust_R2=f,u}return{ols:u}}(),n.extend({buildxmatrix:function(){for(var r=new Array(arguments.length),t=0;t<arguments.length;t++){var e=[1];r[t]=e.concat(arguments[t])}return n(r)},builddxmatrix:function(){for(var r=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var e=[1];r[t]=e.concat(arguments[0][t])}return n(r)},buildjxmatrix:function(r){for(var t=new Array(r.length),e=0;e<r.length;e++)t[e]=r[e];return n.builddxmatrix(t)},buildymatrix:function(r){return n(r).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(r,t){var e,o,u,i,a;if(r.cols()==t.rows()){if(t.rows()>1){for(i=[],e=0;e<r.rows();e++)for(i[e]=[],o=0;o<t.cols();o++){for(a=0,u=0;u<r.cols();u++)a+=r.toArray()[e][u]*t.toArray()[u][o];i[e][o]=a}return n(i)}for(i=[],e=0;e<r.rows();e++)for(i[e]=[],o=0;o<t.cols();o++){for(a=0,u=0;u<r.cols();u++)a+=r.toArray()[e][u]*t.toArray()[o];i[e][o]=a}return n(i)}},regress:function(r,t){var e=n.xtranspxinv(r),o=r.transpose(),u=n.matrixmult(n(e),o);return n.matrixmult(u,t)},regresst:function(r,t,e){var o=n.regress(r,t),u={anova:{}},i=n.jMatYBar(r,o);u.yBar=i;var a=t.mean();u.anova.residuals=n.residuals(t,i),u.anova.ssr=n.ssr(i,a),u.anova.msr=u.anova.ssr/(r[0].length-1),u.anova.sse=n.sse(t,i),u.anova.mse=u.anova.sse/(t.length-(r[0].length-1)-1),u.anova.sst=n.sst(t,a),u.anova.mst=u.anova.sst/(t.length-1),u.anova.r2=1-u.anova.sse/u.anova.sst,u.anova.r2<0&&(u.anova.r2=0),u.anova.fratio=u.anova.msr/u.anova.mse,u.anova.pvalue=n.anovaftest(u.anova.fratio,r[0].length-1,t.length-(r[0].length-1)-1),u.anova.rmse=Math.sqrt(u.anova.mse),u.anova.r2adj=1-u.anova.mse/u.anova.mst,u.anova.r2adj<0&&(u.anova.r2adj=0),u.stats=new Array(r[0].length);for(var f,c,l,s=n.xtranspxinv(r),h=0;h<o.length;h++)f=Math.sqrt(u.anova.mse*Math.abs(s[h][h])),c=Math.abs(o[h]/f),l=n.ttest(c,t.length-r[0].length-1,e),u.stats[h]=[o[h],f,c,l];return u.regress=o,u},xtranspx:function(r){return n.matrixmult(r.transpose(),r)},xtranspxinv:function(r){var t=n.matrixmult(r.transpose(),r);return n.inv(t)},jMatYBar:function(r,t){var e=n.matrixmult(r,t);return new n(e)},residuals:function(r,t){return n.matrixsubtract(r,t)},ssr:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},sse:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r[e],2);return t},sst:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},matrixsubtract:function(r,t){for(var e=new Array(r.length),o=0;o<r.length;o++){e[o]=new Array(r[o].length);for(var u=0;u<r[o].length;u++)e[o][u]=r[o][u]-t[o][u]}return n(e)}}),n.jStat=n,n}();var nr=Jn.exports,rr=O,tr=C,er=x;U.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},F.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")};var or=[">",">=","<","<=","=","<>"],ur="operator",ir="literal",ar=[ur,ir],fr=ur,cr=ir,lr=function(n){for(var r,t=[],e=0;e<n.length;e++){var o=n[e];switch(o.type){case fr:r=o.value;break;case cr:t.push(o.value)}}return function(n,r){var t=!1;switch(r){case">":t=n[0]>n[1];break;case">=":t=n[0]>=n[1];break;case"<":t=n[0]<n[1];break;case"<=":t=n[0]<=n[1];break;case"=":t=n[0]==n[1];break;case"<>":t=n[0]!=n[1]}return t}(t,r)},sr={TYPE:function(n){switch(n){case Vn:return 1;case Gn:return 2;case kn:return 3;case Xn:return 4;case Yn:return 5;case Hn:return 6;case jn:return 7;case zn:return 8}return jn}},hr=e,gr={DIST:function(n,r,t,e,o,u){return arguments.length<4?kn:(o=void 0===o?0:o,u=void 0===u?1:u,v(n=f(n),r=f(r),t=f(t),o=f(o),u=f(u))?kn:(n=(n-o)/(u-o),e?nr.beta.cdf(n,r,t):nr.beta.pdf(n,r,t)))},INV:function(n,r,t,e,o){return e=void 0===e?0:e,o=void 0===o?1:o,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o))?kn:nr.beta.inv(n,r,t)*(o-e)+e}},pr={DIST:function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t),e=f(e))?kn:e?nr.binomial.cdf(n,r,t):nr.binomial.pdf(n,r,t)}};pr.DIST.RANGE=function(n,r,t,e){if(e=void 0===e?t:e,v(n=f(n),r=f(r),t=f(t),e=f(e)))return kn;for(var o=0,u=t;u<=e;u++)o+=In(n,u)*Math.pow(r,u)*Math.pow(1-r,n-u);return o},pr.INV=function(n,r,t){if(v(n=f(n),r=f(r),t=f(t)))return kn;for(var e=0;e<=n;){if(nr.binomial.cdf(e,n,r)>=t)return e;e++}};var vr={DIST:function(n,r,t){return v(n=f(n),r=f(r))?kn:t?nr.chisquare.cdf(n,r):nr.chisquare.pdf(n,r)}};vr.DIST.RT=function(n,r){return!n|!r?jn:n<1||r>Math.pow(10,10)?Hn:"number"!=typeof n||"number"!=typeof r?kn:1-nr.chisquare.cdf(n,r)},vr.INV=function(n,r){return v(n=f(n),r=f(r))?kn:nr.chisquare.inv(n,r)},vr.INV.RT=function(n,r){return!n|!r?jn:n<0||n>1||r<1||r>Math.pow(10,10)?Hn:"number"!=typeof n||"number"!=typeof r?kn:nr.chisquare.inv(1-n,r)},vr.TEST=function(n,r){function t(n,r){var t=Math.exp(-.5*n);r%2==1&&(t*=Math.sqrt(2*n/l));for(var e=r;e>=2;)t=t*n/e,e-=2;for(var o=t,u=r;o>1e-10*t;)t+=o=o*n/(u+=2);return 1-t}if(2!==arguments.length)return jn;if(!(n instanceof Array&&r instanceof Array))return kn;if(n.length!==r.length)return kn;if(n[0]&&r[0]&&n[0].length!==r[0].length)return kn;var e,o,u,i=n.length;for(o=0;o<i;o++)n[o]instanceof Array||(e=n[o],n[o]=[],n[o].push(e)),r[o]instanceof Array||(e=r[o],r[o]=[],r[o].push(e));var a=n[0].length,f=1===a?i-1:(i-1)*(a-1),c=0,l=Math.PI;for(o=0;o<i;o++)for(u=0;u<a;u++)c+=Math.pow(n[o][u]-r[o][u],2)/r[o][u];return Math.round(1e6*t(c,f))/1e6};var mr={NORM:function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:nr.normalci(1,n,r,t)[1]-1},T:function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:nr.tci(1,n,r,t)[1]-1}},dr={P:function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;for(var t=nr.mean(n),o=nr.mean(r),u=0,i=n.length,a=0;a<i;a++)u+=(n[a]-t)*(r[a]-o);return u/i},S:function(n,r){return v(n=l(e(n)),r=l(e(r)))?kn:nr.covariance(n,r)}},Er={DIST:function(n,r,t){return v(n=f(n),r=f(r))?kn:t?nr.exponential.cdf(n,r):nr.exponential.pdf(n,r)}},Mr={DIST:function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t))?kn:e?nr.centralF.cdf(n,r,t):nr.centralF.pdf(n,r,t)}};Mr.DIST.RT=function(n,r,t){return 3!==arguments.length?jn:n<0||r<1||t<1?Hn:"number"!=typeof n||"number"!=typeof r||"number"!=typeof t?kn:1-nr.centralF.cdf(n,r,t)},Mr.INV=function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:n<=0||n>1?Hn:nr.centralF.inv(n,r,t)},Mr.INV.RT=function(n,r,t){return 3!==arguments.length?jn:n<0||n>1||r<1||r>Math.pow(10,10)||t<1||t>Math.pow(10,10)?Hn:"number"!=typeof n||"number"!=typeof r||"number"!=typeof t?kn:nr.centralF.inv(1-n,r,t)},Mr.TEST=function(n,r){if(!n||!r)return jn;if(!(n instanceof Array&&r instanceof Array))return jn;if(n.length<2||r.length<2)return Gn;var t=function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},e=Dn(n)/n.length,o=Dn(r)/r.length;return t(n,e)/(n.length-1)/(t(r,o)/(r.length-1))},cn.DIST=function(n,r,t,e){return 4!==arguments.length?jn:n<0||r<=0||t<=0||"number"!=typeof n||"number"!=typeof r||"number"!=typeof t?kn:e?nr.gamma.cdf(n,r,t,!0):nr.gamma.pdf(n,r,t,!1)},cn.INV=function(n,r,t){return 3!==arguments.length?jn:n<0||n>1||r<=0||t<=0?Hn:"number"!=typeof n||"number"!=typeof r||"number"!=typeof t?kn:nr.gamma.inv(n,r,t)},ln.PRECISE=function(n){return 1!==arguments.length?jn:n<=0?Hn:"number"!=typeof n?kn:nr.gammaln(n)};var Nr={DIST:function(n,r,t,e,o){function u(n,r,t,e){return In(t,n)*In(e-t,r-n)/In(e,r)}return v(n=f(n),r=f(r),t=f(t),e=f(e))?kn:o?function(n,r,t,e){for(var o=0,i=0;i<=n;i++)o+=u(i,r,t,e);return o}(n,r,t,e):u(n,r,t,e)}},wr={DIST:function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t))?kn:e?nr.lognormal.cdf(n,r,t):nr.lognormal.pdf(n,r,t)},INV:function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:nr.lognormal.inv(n,r,t)}},Ir={MULT:function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r,t=n.length,o={},u=[],i=0,a=0;a<t;a++)o[r=n[a]]=o[r]?o[r]+1:1,o[r]>i&&(i=o[r],u=[]),o[r]===i&&(u[u.length]=r);return u},SNGL:function(){var n=l(e(arguments));return n instanceof Error?n:Ir.MULT(n).sort(function(n,r){return n-r})[0]}},yr={DIST:function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t))?kn:e?nr.negbin.cdf(n,r,t):nr.negbin.pdf(n,r,t)}},br={DIST:function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t))?kn:t<=0?Hn:e?nr.normal.cdf(n,r,t):nr.normal.pdf(n,r,t)},INV:function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:nr.normal.inv(n,r,t)},S:{}};br.S.DIST=function(n,r){return(n=f(n))instanceof Error?kn:r?nr.normal.cdf(n,0,1):nr.normal.pdf(n,0,1)},br.S.INV=function(n){return(n=f(n))instanceof Error?kn:nr.normal.inv(n,0,1)};var Tr={EXC:function(n,r){if(v(n=l(e(n)),r=f(r)))return kn;var t=(n=n.sort(function(n,r){return n-r})).length;if(r<1/(t+1)||r>1-1/(t+1))return Hn;var o=r*(t+1)-1,u=Math.floor(o);return i(o===u?n[o]:n[u]+(o-u)*(n[u+1]-n[u]))},INC:function(n,r){if(v(n=l(e(n)),r=f(r)))return kn;var t=r*((n=n.sort(function(n,r){return n-r})).length-1),o=Math.floor(t);return i(t===o?n[t]:n[o]+(t-o)*(n[o+1]-n[o]))}},Sr={EXC:function(n,r,t){if(t=void 0===t?3:t,v(n=l(e(n)),r=f(r),t=f(t)))return kn;n=n.sort(function(n,r){return n-r});for(var o=rn.apply(null,n),u=n.length,i=o.length,a=Math.pow(10,t),c=0,s=!1,h=0;!s&&h<i;)r===o[h]?(c=(n.indexOf(o[h])+1)/(u+1),s=!0):r>=o[h]&&(r<o[h+1]||h===i-1)&&(c=(n.indexOf(o[h])+1+(r-o[h])/(o[h+1]-o[h]))/(u+1),s=!0),h++;return Math.floor(c*a)/a},INC:function(n,r,t){if(t=void 0===t?3:t,v(n=l(e(n)),r=f(r),t=f(t)))return kn;n=n.sort(function(n,r){return n-r});for(var o=rn.apply(null,n),u=n.length,i=o.length,a=Math.pow(10,t),c=0,s=!1,h=0;!s&&h<i;)r===o[h]?(c=n.indexOf(o[h])/(u-1),s=!0):r>=o[h]&&(r<o[h+1]||h===i-1)&&(c=(n.indexOf(o[h])+(r-o[h])/(o[h+1]-o[h]))/(u-1),s=!0),h++;return Math.floor(c*a)/a}},Ar={DIST:function(n,r,t){return v(n=f(n),r=f(r))?kn:t?nr.poisson.cdf(n,r):nr.poisson.pdf(n,r)}},Dr={EXC:function(n,r){if(v(n=l(e(n)),r=f(r)))return kn;switch(r){case 1:return Tr.EXC(n,.25);case 2:return Tr.EXC(n,.5);case 3:return Tr.EXC(n,.75);default:return Hn}},INC:function(n,r){if(v(n=l(e(n)),r=f(r)))return kn;switch(r){case 1:return Tr.INC(n,.25);case 2:return Tr.INC(n,.5);case 3:return Tr.INC(n,.75);default:return Hn}}},Rr={AVG:function(n,r,t){if(v(n=f(n),r=l(e(r))))return kn;for(var o=(t=t||!1)?function(n,r){return n-r}:function(n,r){return r-n},u=(r=(r=e(r)).sort(o)).length,i=0,a=0;a<u;a++)r[a]===n&&i++;return i>1?(2*r.indexOf(n)+i+1)/2:r.indexOf(n)+1},EQ:function(n,r,t){if(v(n=f(n),r=l(e(r))))return kn;var o=(t=t||!1)?function(n,r){return n-r}:function(n,r){return r-n};return(r=r.sort(o)).indexOf(n)+1}};dn.P=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=nr.mean(n),t=n.length,o=0,u=0,i=0;i<t;i++)u+=Math.pow(n[i]-r,3),o+=Math.pow(n[i]-r,2);return o/=t,(u/=t)/Math.pow(o,1.5)};var Cr={P:function(){var n=Or.P.apply(this,arguments),r=Math.sqrt(n);return isNaN(r)&&(r=Hn),r},S:function(){var n=Or.S.apply(this,arguments);return Math.sqrt(n)}},xr={DIST:function(n,r,t){return 1!==t&&2!==t?Hn:1===t?xr.DIST.RT(n,r):xr.DIST["2T"](n,r)}};xr.DIST["2T"]=function(n,r){return 2!==arguments.length?jn:n<0||r<1?Hn:"number"!=typeof n||"number"!=typeof r?kn:2*(1-nr.studentt.cdf(n,r))},xr.DIST.RT=function(n,r){return 2!==arguments.length?jn:n<0||r<1?Hn:"number"!=typeof n||"number"!=typeof r?kn:1-nr.studentt.cdf(n,r)},xr.INV=function(n,r){return v(n=f(n),r=f(r))?kn:nr.studentt.inv(n,r)},xr.INV["2T"]=function(n,r){return n=f(n),r=f(r),n<=0||n>1||r<1?Hn:v(n,r)?kn:Math.abs(nr.studentt.inv(n/2,r))},xr.TEST=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;var t,o=nr.mean(n),u=nr.mean(r),i=0,a=0;for(t=0;t<n.length;t++)i+=Math.pow(n[t]-o,2);for(t=0;t<r.length;t++)a+=Math.pow(r[t]-u,2);i/=n.length-1,a/=r.length-1;var f=Math.abs(o-u)/Math.sqrt(i/n.length+a/r.length);return xr.DIST["2T"](f,n.length+r.length-2)};var Or={P:function(){for(var n,r=u(e(arguments)),t=r.length,o=0,i=tn(r),a=0;a<t;a++)o+=Math.pow(r[a]-i,2);return n=o/t,isNaN(n)&&(n=Hn),n},S:function(){for(var n=u(e(arguments)),r=n.length,t=0,o=tn(n),i=0;i<r;i++)t+=Math.pow(n[i]-o,2);return t/(r-1)}},Pr={DIST:function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t))?kn:e?1-Math.exp(-Math.pow(n/t,r)):Math.pow(n,r-1)*Math.exp(-Math.pow(n/t,r))*r/Math.pow(t,r)}},Lr={TEST:function(n,r,t){if(v(n=l(e(n)),r=f(r)))return kn;t=t||Cr.S(n);var o=n.length;return 1-br.S.DIST((tn(n)-r)/(t/Math.sqrt(o)),!0)}};wn.MATH=wn,wn.PRECISE=wn;var qr=[];bn.MATH=function(n,r,t){if(r instanceof Error)return r;r=void 0===r?0:r;var e=g(n=f(n),r=f(r),t=f(t));if(e)return e;if(0===r)return 0;r=r?Math.abs(r):1;var o=-Math.floor(Math.log(r)/Math.log(10));return n>=0?An(Math.floor(n/r)*r,o):0===t||void 0===t?-An(Math.ceil(Math.abs(n)/r)*r,o):-An(Math.floor(Math.abs(n)/r)*r,o)},bn.PRECISE=bn.MATH;var Ur={CEILING:wn},Fr=gr.DIST,_r=gr.INV,Vr=pr.DIST,Gr=wn.MATH,kr=wn.PRECISE,Xr=vr.DIST,Yr=vr.DIST.RT,Hr=vr.INV,jr=vr.INV.RT,Br=vr.TEST,zr=dr.P,Kr=dr.P,Wr=dr.S,Qr=pr.INV,$r=F.PRECISE,Zr=U.PRECISE,Jr=Er.DIST,nt=Mr.DIST,rt=Mr.DIST.RT,tt=Mr.INV,et=Mr.INV.RT,ot=bn.MATH,ut=bn.PRECISE,it=Mr.TEST,at=cn.DIST,ft=cn.INV,ct=ln.PRECISE,lt=Nr.DIST,st=wr.INV,ht=wr.DIST,gt=wr.INV,pt=Ir.MULT,vt=Ir.SNGL,mt=yr.DIST,dt=b.INTL,Et=br.DIST,Mt=br.INV,Nt=br.S.DIST,wt=br.S.INV,It=Tr.EXC,yt=Tr.INC,bt=Sr.EXC,Tt=Sr.INC,St=Ar.DIST,At=Dr.EXC,Dt=Dr.INC,Rt=Rr.AVG,Ct=Rr.EQ,xt=dn.P,Ot=Cr.P,Pt=Cr.S,Lt=xr.DIST,qt=xr.DIST.RT,Ut=xr.INV,Ft=xr.TEST,_t=Or.P,Vt=Or.S,Gt=Pr.DIST,kt=T.INTL,Xt=Lr.TEST;n.ABS=function(n){return(n=f(n))instanceof Error?n:Math.abs(n)},n.ACCRINT=function(n,r,t,e,o,u,i){return n=Pn(n),r=Pn(r),t=Pn(t),On(n)&&On(r)&&On(t)?e<=0||o<=0||-1===[1,2,4].indexOf(u)||-1===[0,1,2,3,4].indexOf(i)||t<=n?Hn:(o=o||0)*e*D(n,t,i=i||0):kn},n.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},n.ACOS=function(n){if((n=f(n))instanceof Error)return n;var r=Math.acos(n);return isNaN(r)&&(r=Hn),r},n.ACOSH=function(n){if((n=f(n))instanceof Error)return n;var r=Math.log(n+Math.sqrt(n*n-1));return isNaN(r)&&(r=Hn),r},n.ACOT=function(n){return(n=f(n))instanceof Error?n:Math.atan(1/n)},n.ACOTH=function(n){if((n=f(n))instanceof Error)return n;var r=.5*Math.log((n+1)/(n-1));return isNaN(r)&&(r=Hn),r},n.ADD=function(n,r){return 2!==arguments.length?jn:g(n=f(n),r=f(r))||n+r},n.AGGREGATE=function(n,r,t,e){if(v(n=f(n),f(n)))return kn;switch(n){case 1:return tn(t);case 2:return on(t);case 3:return un(t);case 4:return gn(t);case 5:return vn(t);case 6:return Sn(t);case 7:return Cr.S(t);case 8:return Cr.P(t);case 9:return Dn(t);case 10:return Or.S(t);case 11:return Or.P(t);case 12:return pn(t);case 13:return Ir.SNGL(t);case 14:return sn(t,e);case 15:return En(t,e);case 16:return Tr.INC(t,e);case 17:return Dr.INC(t,e);case 18:return Tr.EXC(t,e);case 19:return Dr.EXC(t,e)}},n.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},n.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},n.AND=function(){for(var n=e(arguments),r=kn,t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];void 0!==n[t]&&null!==n[t]&&"string"!=typeof n[t]&&(r===kn&&(r=!0),n[t]||(r=!1))}return r},n.ARABIC=function(n){if(null==n)return 0;if(n instanceof Error)return n;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))return kn;var r=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(n){r+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),r},n.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},n.ASC=function(){throw new Error("ASC is not implemented")},n.ASIN=function(n){if((n=f(n))instanceof Error)return n;var r=Math.asin(n);return isNaN(r)&&(r=Hn),r},n.ASINH=function(n){return(n=f(n))instanceof Error?n:Math.log(n+Math.sqrt(n*n+1))},n.ATAN=function(n){return(n=f(n))instanceof Error?n:Math.atan(n)},n.ATAN2=function(n,r){return g(n=f(n),r=f(r))||Math.atan2(n,r)},n.ATANH=function(n){if((n=f(n))instanceof Error)return n;var r=Math.log((1+n)/(1-n))/2;return isNaN(r)&&(r=Hn),r},n.AVEDEV=function(){var n=e(arguments).filter(p);if(0===n.length)return Hn;var r=l(n);return r instanceof Error?r:nr.sum(nr(r).subtract(nr.mean(r)).abs()[0])/r.length},n.AVERAGE=tn,n.AVERAGEA=en,n.AVERAGEIF=function(n,r,t){if(arguments.length<=1)return jn;var o=e(t=t||n);if(t=l(o.filter(p)),n=e(n),t instanceof Error)return t;for(var u=0,i=0,a=void 0===r||"*"===r,f=a?null:W(r+""),c=0;c<n.length;c++){var s=n[c];if(a)i+=t[c],u++;else{var h=[z(s,cr)].concat(f);lr(h)&&(i+=t[c],u++)}}return i/u},n.AVERAGEIFS=function(){for(var n=o(arguments),r=(n.length-1)/2,t=e(n[0]),u=0,i=0,a=0;a<t.length;a++){for(var f=!1,c=0;c<r;c++){var l=n[2*c+1][a],s=n[2*c+2],h=!1;if(void 0===s||"*"===s)h=!0;else{var g=W(s+""),p=[z(l,cr)].concat(g);h=lr(p)}if(!h){f=!1;break}f=!0}f&&(i+=t[a],u++)}var v=i/u;return isNaN(v)?0:v},n.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},n.BASE=function(n,r,t){var e=g(n=f(n),r=f(r),t=f(t));if(e)return e;if(0===r)return Hn;var o=n.toString(r);return new Array(Math.max(t+1-o.length,0)).join("0")+o},n.BESSELI=function(n,r){return v(n=f(n),r=f(r))?kn:Zn.besseli(n,r)},n.BESSELJ=function(n,r){return v(n=f(n),r=f(r))?kn:Zn.besselj(n,r)},n.BESSELK=function(n,r){return v(n=f(n),r=f(r))?kn:Zn.besselk(n,r)},n.BESSELY=function(n,r){return v(n=f(n),r=f(r))?kn:Zn.bessely(n,r)},n.BETA=gr,n.BETADIST=Fr,n.BETAINV=_r,n.BIN2DEC=function(n){if(!L(n))return Hn;var r=parseInt(n,2),t=n.toString();return 10===t.length&&"1"===t.substring(0,1)?parseInt(t.substring(1),2)-512:r},n.BIN2HEX=function(n,r){if(!L(n))return Hn;var t=n.toString();if(10===t.length&&"1"===t.substring(0,1))return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);var e=parseInt(n,2).toString(16);return void 0===r?e:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=e.length?P("0",r-e.length)+e:Hn},n.BIN2OCT=function(n,r){if(!L(n))return Hn;var t=n.toString();if(10===t.length&&"1"===t.substring(0,1))return(1073741312+parseInt(t.substring(1),2)).toString(8);var e=parseInt(n,2).toString(8);return void 0===r?e:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=e.length?P("0",r-e.length)+e:Hn},n.BINOM=pr,n.BINOMDIST=Vr,n.BITAND=function(n,r){return v(n=f(n),r=f(r))?kn:n<0||r<0||Math.floor(n)!==n||Math.floor(r)!==r||n>0xffffffffffff||r>0xffffffffffff?Hn:n&r},n.BITLSHIFT=function(n,r){return v(n=f(n),r=f(r))?kn:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(r)>53?Hn:r>=0?n<<r:n>>-r},n.BITOR=function(n,r){return v(n=f(n),r=f(r))?kn:n<0||r<0||Math.floor(n)!==n||Math.floor(r)!==r||n>0xffffffffffff||r>0xffffffffffff?Hn:n|r},n.BITRSHIFT=function(n,r){return v(n=f(n),r=f(r))?kn:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(r)>53?Hn:r>=0?n>>r:n<<-r},n.BITXOR=function(n,r){return v(n=f(n),r=f(r))?kn:n<0||r<0||Math.floor(n)!==n||Math.floor(r)!==r||n>0xffffffffffff||r>0xffffffffffff?Hn:n^r},n.CEILING=wn,n.CEILINGMATH=Gr,n.CEILINGPRECISE=kr,n.CELL=function(){throw new Error("CELL is not implemented")},n.CHAR=C,n.CHIDIST=Xr,n.CHIDISTRT=Yr,n.CHIINV=Hr,n.CHIINVRT=jr,n.CHISQ=vr,n.CHITEST=Br,n.CHOOSE=function(){if(arguments.length<2)return jn;var n=arguments[0];return n<1||n>254||arguments.length<n+1?kn:arguments[n]},n.CLEAN=function(n){return v(n)?n:(n=n||"").replace(/[\0-\x1F]/g,"")},n.CODE=x,n.COLUMN=function(n,r){return 2!==arguments.length?jn:r<0?Hn:n instanceof Array&&"number"==typeof r?0!==n.length?nr.col(n,r):void 0:kn},n.COLUMNS=function(n){return 1!==arguments.length?jn:n instanceof Array?0===n.length?0:nr.cols(n):kn},n.COMBIN=In,n.COMBINA=function(n,r){return g(n=f(n),r=f(r))||(n<r?Hn:0===n&&0===r?1:In(n+r-1,n-1))},n.COMPLEX=q,n.CONCAT=rr,n.CONCATENATE=O,n.CONFIDENCE=mr,n.CONVERT=function(n,r,t){if((n=f(n))instanceof Error)return n;for(var e,o=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xe5ngstr\xf6m","\xc5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xe5ngstr\xf6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","\xb0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xe4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xe5ngstr\xf6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},i={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},a=null,c=null,l=r,s=t,h=1,g=1,p=0;p<o.length;p++)e=null===o[p][2]?[]:o[p][2],(o[p][1]===l||e.indexOf(l)>=0)&&(a=o[p]),(o[p][1]===s||e.indexOf(s)>=0)&&(c=o[p]);if(null===a){var v=u[r.substring(0,2)],m=i[r.substring(0,1)];"da"===r.substring(0,2)&&(m=["dekao",10,"da"]),v?(h=v[2],l=r.substring(2)):m&&(h=m[1],l=r.substring(m[2].length));for(var d=0;d<o.length;d++)e=null===o[d][2]?[]:o[d][2],(o[d][1]===l||e.indexOf(l)>=0)&&(a=o[d])}if(null===c){var E=u[t.substring(0,2)],M=i[t.substring(0,1)];"da"===t.substring(0,2)&&(M=["dekao",10,"da"]),
E?(g=E[2],s=t.substring(2)):M&&(g=M[1],s=t.substring(M[2].length));for(var N=0;N<o.length;N++)e=null===o[N][2]?[]:o[N][2],(o[N][1]===s||e.indexOf(s)>=0)&&(c=o[N])}return null===a||null===c||a[3]!==c[3]?jn:n*a[6]*h/(c[6]*g)},n.CORREL=function(n,r){return v(n=l(e(n)),r=l(e(r)))?kn:nr.corrcoeff(n,r)},n.COS=function(n){return(n=f(n))instanceof Error?n:Math.cos(n)},n.COSH=function(n){return(n=f(n))instanceof Error?n:(Math.exp(n)+Math.exp(-n))/2},n.COT=function(n){return(n=f(n))instanceof Error?n:0===n?Gn:1/Math.tan(n)},n.COTH=function(n){if((n=f(n))instanceof Error)return n;if(0===n)return Gn;var r=Math.exp(2*n);return(r+1)/(r-1)},n.COUNT=on,n.COUNTA=un,n.COUNTBLANK=an,n.COUNTIF=function(n,r){if(n=e(n),void 0===r||"*"===r)return n.length;for(var t=0,o=W(r+""),u=0;u<n.length;u++){var i=[z(n[u],cr)].concat(o);lr(i)&&t++}return t},n.COUNTIFS=function(){for(var n=o(arguments),r=new Array(e(n[0]).length),t=0;t<r.length;t++)r[t]=!0;for(var u=0;u<n.length;u+=2){var i=e(n[u]),a=n[u+1];if(!(void 0===a||"*"===a))for(var f=W(a+""),c=0;c<i.length;c++){var l=[z(i[c],cr)].concat(f);r[c]=r[c]&&lr(l)}}for(var s=0,h=0;h<r.length;h++)r[h]&&s++;return s},n.COUNTIN=function(n,r){var t=0;n=e(n);for(var o=0;o<n.length;o++)n[o]===r&&t++;return t},n.COUNTUNIQUE=function(){return rn.apply(null,e(arguments)).length},n.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},n.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},n.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},n.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},n.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},n.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},n.COVAR=zr,n.COVARIANCE=dr,n.COVARIANCEP=Kr,n.COVARIANCES=Wr,n.CRITBINOM=Qr,n.CSC=function(n){return(n=f(n))instanceof Error?n:0===n?Gn:1/Math.sin(n)},n.CSCH=function(n){return(n=f(n))instanceof Error?n:0===n?Gn:2/(Math.exp(n)-Math.exp(-n))},n.CUMIPMT=function(n,r,t,e,o,u){if(v(n=f(n),r=f(r),t=f(t)))return kn;if(n<=0||r<=0||t<=0)return Hn;if(e<1||o<1||e>o)return Hn;if(0!==u&&1!==u)return Hn;var i=Fn(n,r,t,0,u),a=0;1===e&&(0===u&&(a=-t),e++);for(var c=e;c<=o;c++)a+=1===u?Ln(n,c-2,i,t,1)-i:Ln(n,c-1,i,t,0);return a*n},n.CUMPRINC=function(n,r,t,e,o,u){if(v(n=f(n),r=f(r),t=f(t)))return kn;if(n<=0||r<=0||t<=0)return Hn;if(e<1||o<1||e>o)return Hn;if(0!==u&&1!==u)return Hn;var i=Fn(n,r,t,0,u),a=0;1===e&&(a=0===u?i+t*n:i,e++);for(var c=e;c<=o;c++)a+=u>0?i-(Ln(n,c-2,i,t,1)-i)*n:i-Ln(n,c-1,i,t,0)*n;return a},n.DATE=function(n,r,t){var e;return v(n=f(n),r=f(r),t=f(t))?e=kn:(e=new Date(n,r-1,t)).getFullYear()<0&&(e=Hn),e},n.DATEDIF=function(n,r,t){t=t.toUpperCase(),n=s(n),r=s(r);var e,o=n.getFullYear(),u=n.getMonth(),i=n.getDate(),a=r.getFullYear(),f=r.getMonth(),c=r.getDate();switch(t){case"Y":e=Math.floor(D(n,r));break;case"D":e=w(r,n);break;case"M":e=f-u+12*(a-o),c<i&&e--;break;case"MD":i<=c?e=c-i:(0===f?(n.setFullYear(a-1),n.setMonth(12)):(n.setFullYear(a),n.setMonth(f-1)),e=w(r,n));break;case"YM":e=f-u+12*(a-o),c<i&&e--,e%=12;break;case"YD":f>u||f===u&&c<i?n.setFullYear(a):n.setFullYear(a-1),e=w(r,n)}return e},n.DATEVALUE=function(n){if("string"!=typeof n)return kn;var r=Date.parse(n);return isNaN(r)?kn:new Date(n)},n.DAVERAGE=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=0;return M(e,function(n){i+=o[n]}),0===e.length?Gn:i/e.length},n.DAY=function(n){var r=s(n);return r instanceof Error?r:r.getDate()},n.DAYS=w,n.DAYS360=I,n.DB=function(n,r,t,e,o){if(o=void 0===o?12:o,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o)))return kn;if(n<0||r<0||t<0||e<0)return Hn;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return Hn;if(e>t)return Hn;if(r>=n)return 0;for(var u=(1-Math.pow(r/n,1/t)).toFixed(3),i=n*u*o/12,a=i,c=0,l=e===t?t-1:e,s=2;s<=l;s++)a+=c=(n-a)*u;return 1===e?i:e===t?(n-a)*u:c},n.DBCS=function(){throw new Error("DBCS is not implemented")},n.DCOUNT=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];return M(e,function(n){i.push(o[n])}),on(i)},n.DCOUNTA=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];return M(e,function(n){i.push(o[n])}),un(i)},n.DDB=function(n,r,t,e,o){if(o=void 0===o?2:o,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o)))return kn;if(n<0||r<0||t<0||e<0||o<=0)return Hn;if(e>t)return Hn;if(r>=n)return 0;for(var u=0,i=0,a=1;a<=e;a++)u+=i=Math.min(o/t*(n-u),n-r-u);return i},n.DEC2BIN=function(n,r){if((n=f(n))instanceof Error)return n;if(!/^-?[0-9]{1,3}$/.test(n)||n<-512||n>511)return Hn;if(n<0)return"1"+P("0",9-(512+n).toString(2).length)+(512+n).toString(2);var t=parseInt(n,10).toString(2);return void 0===r?t:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=t.length?P("0",r-t.length)+t:Hn},n.DEC2HEX=function(n,r){if((n=f(n))instanceof Error)return n;if(!/^-?[0-9]{1,12}$/.test(n)||n<-549755813888||n>549755813887)return Hn;if(n<0)return(1099511627776+n).toString(16);var t=parseInt(n,10).toString(16);return void 0===r?t:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=t.length?P("0",r-t.length)+t:Hn},n.DEC2OCT=function(n,r){if((n=f(n))instanceof Error)return n;if(!/^-?[0-9]{1,9}$/.test(n)||n<-536870912||n>536870911)return Hn;if(n<0)return(1073741824+n).toString(8);var t=parseInt(n,10).toString(8);return void 0===r?t:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=t.length?P("0",r-t.length)+t:Hn},n.DECIMAL=function(n,r){return arguments.length<1?kn:g(n=f(n),r=f(r))||(0===r?Hn:parseInt(n,r))},n.DEGREES=function(n){return(n=f(n))instanceof Error?n:180*n/Math.PI},n.DELTA=function(n,r){return r=void 0===r?0:r,v(n=f(n),r=f(r))?kn:n===r?1:0},n.DEVSQ=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=nr.mean(n),t=0,o=0;o<n.length;o++)t+=Math.pow(n[o]-r,2);return t},n.DGET=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];return o=E("string"==typeof r?n[Cn(n,r)]:n[r]),0===e.length?kn:e.length>1?Hn:o[e[0]]},n.DISC=function(){throw new Error("DISC is not implemented")},n.DIVIDE=function(n,r){return 2!==arguments.length?jn:g(n=f(n),r=f(r))||(0===r?Gn:n/r)},n.DMAX=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=o[e[0]];return M(e,function(n){i<o[n]&&(i=o[n])}),i},n.DMIN=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=o[e[0]];return M(e,function(n){i>o[n]&&(i=o[n])}),i},n.DOLLAR=function(){throw new Error("DOLLAR is not implemented")},n.DOLLARDE=function(n,r){if(v(n=f(n),r=f(r)))return kn;if(r<0)return Hn;if(r>=0&&r<1)return Gn;r=parseInt(r,10);var t=parseInt(n,10);t+=n%1*Math.pow(10,Math.ceil(Math.log(r)/Math.LN10))/r;var e=Math.pow(10,Math.ceil(Math.log(r)/Math.LN2)+1);return Math.round(t*e)/e},n.DOLLARFR=function(n,r){return v(n=f(n),r=f(r))?kn:r<0?Hn:r>=0&&r<1?Gn:(r=parseInt(r,10),parseInt(n,10)+n%1*Math.pow(10,-Math.ceil(Math.log(r)/Math.LN10))*r)},n.DPRODUCT=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];M(e,function(n){i.push(o[n])}),i=Rn(i);var a=1;return M(i,function(n){a*=n}),a},n.DSTDEV=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];return M(e,function(n){i.push(o[n])}),i=Rn(i),Cr.S(i)},n.DSTDEVP=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];return M(e,function(n){i.push(o[n])}),i=Rn(i),Cr.P(i)},n.DSUM=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];return M(e,function(n){i.push(o[n])}),Dn(i)},n.DURATION=function(){throw new Error("DURATION is not implemented")},n.DVAR=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];return M(e,function(n){i.push(o[n])}),Or.S(i)},n.DVARP=function(n,r,t){if(isNaN(r)&&"string"!=typeof r)return kn;var e=xn(n,t),o=[];if("string"==typeof r){var u=Cn(n,r);o=E(n[u])}else o=E(n[r]);var i=[];return M(e,function(n){i.push(o[n])}),Or.P(i)},n.E=function(){return Math.E},n.EDATE=function(n,r){return(n=s(n))instanceof Error?n:isNaN(r)?kn:(r=parseInt(r,10),n.setMonth(n.getMonth()+r),n)},n.EFFECT=function(n,r){return v(n=f(n),r=f(r))?kn:n<=0||r<1?Hn:(r=parseInt(r,10),Math.pow(1+n/r,r)-1)},n.EOMONTH=function(n,r){return(n=s(n))instanceof Error?n:isNaN(r)?kn:(r=parseInt(r,10),new Date(n.getFullYear(),n.getMonth()+r+1,0))},n.EQ=function(n,r){return 2!==arguments.length?jn:n instanceof Error?n:r instanceof Error?r:(null===n&&(n=void 0),null===r&&(r=void 0),n===r)},n.ERF=U,n.ERFC=F,n.ERFCPRECISE=$r,n.ERFPRECISE=Zr,n.ERROR=sr,n.EVEN=function(n){return(n=f(n))instanceof Error?n:wn(n,-2,-1)},n.EXACT=function(n,r){return 2!==arguments.length?jn:g(n,r)||(n=c(n))===c(r)},n.EXP=function(n){return arguments.length<1?jn:arguments.length>1?Bn:(n=f(n))instanceof Error?n:n=Math.exp(n)},n.EXPON=Er,n.EXPONDIST=Jr,n.F=Mr,n.FACT=yn,n.FACTDOUBLE=function Yt(n){if((n=f(n))instanceof Error)return n;var r=Math.floor(n);return r<=0?1:r*Yt(r-2)},n.FALSE=function(){return!1},n.FDIST=nt,n.FDISTRT=rt,n.FIND=function(n,r,t){if(arguments.length<2)return jn;n=c(n),t=void 0===t?0:t;var e=(r=c(r)).indexOf(n,t-1);return-1===e?kn:e+1},n.FINDFIELD=Cn,n.FINV=tt,n.FINVRT=et,n.FISHER=function(n){return(n=f(n))instanceof Error?n:Math.log((1+n)/(1-n))/2},n.FISHERINV=function(n){if((n=f(n))instanceof Error)return n;var r=Math.exp(2*n);return(r-1)/(r+1)},n.FIXED=function(){throw new Error("FIXED is not implemented")},n.FLATTEN=hr,n.FLOOR=bn,n.FLOORMATH=ot,n.FLOORPRECISE=ut,n.FORECAST=fn,n.FREQUENCY=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;for(var t=n.length,o=r.length,u=[],i=0;i<=o;i++){u[i]=0;for(var a=0;a<t;a++)0===i?n[a]<=r[0]&&(u[0]+=1):i<o?n[a]>r[i-1]&&n[a]<=r[i]&&(u[i]+=1):i===o&&n[a]>r[o-1]&&(u[o]+=1)}return u},n.FTEST=it,n.FV=Ln,n.FVSCHEDULE=function(n,r){if(v(n=f(n),r=l(e(r))))return kn;for(var t=r.length,o=n,u=0;u<t;u++)o*=1+r[u];return o},n.GAMMA=cn,n.GAMMADIST=at,n.GAMMAINV=ft,n.GAMMALN=ln,n.GAMMALNPRECISE=ct,n.GAUSS=function(n){return(n=f(n))instanceof Error?n:nr.normal.cdf(n,0,1)-.5},n.GCD=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=n.length,t=n[0],o=t<0?-t:t,u=1;u<r;u++){for(var i=n[u],a=i<0?-i:i;o&&a;)o>a?o%=a:a%=o;o+=a}return o},n.GEOMEAN=function(){var n=l(e(arguments));return n instanceof Error?n:nr.geomean(n)},n.GESTEP=function(n,r){return v(r=r||0,n=f(n))?n:n>=r?1:0},n.GROWTH=function(n,r,t,e){if((n=l(n))instanceof Error)return n;var o;if(void 0===r)for(r=[],o=1;o<=n.length;o++)r.push(o);if(void 0===t)for(t=[],o=1;o<=n.length;o++)t.push(o);if(v(r=l(r),t=l(t)))return kn;void 0===e&&(e=!0);var u,i,a=n.length,f=0,c=0,s=0,h=0;for(o=0;o<a;o++){var g=r[o],p=Math.log(n[o]);f+=g,c+=p,s+=g*p,h+=g*g}f/=a,c/=a,s/=a,h/=a,e?i=c-(u=(s-f*c)/(h-f*f))*f:(u=s/h,i=0);var m=[];for(o=0;o<t.length;o++)m.push(Math.exp(i+u*t[o]));return m},n.GT=function(n,r){return 2!==arguments.length?jn:n instanceof Error?n:r instanceof Error?r:(m(n,r)?(n=c(n),r=c(r)):(n=f(n),r=f(r)),g(n,r)||n>r)},n.GTE=function(n,r){return 2!==arguments.length?jn:(m(n,r)?(n=c(n),r=c(r)):(n=f(n),r=f(r)),g(n,r)||n>=r)},n.HARMEAN=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=n.length,t=0,o=0;o<r;o++)t+=1/n[o];return r/t},n.HEX2BIN=function(n,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return Hn;var t=!(10!==n.length||"f"!==n.substring(0,1).toLowerCase()),e=t?parseInt(n,16)-1099511627776:parseInt(n,16);if(e<-512||e>511)return Hn;if(t)return"1"+P("0",9-(512+e).toString(2).length)+(512+e).toString(2);var o=e.toString(2);return void 0===r?o:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=o.length?P("0",r-o.length)+o:Hn},n.HEX2DEC=function(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return Hn;var r=parseInt(n,16);return r>=549755813888?r-1099511627776:r},n.HEX2OCT=function(n,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return Hn;var t=parseInt(n,16);if(t>536870911&&t<0xffe0000000)return Hn;if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);var e=t.toString(8);return void 0===r?e:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=e.length?P("0",r-e.length)+e:Hn},n.HLOOKUP=function(n,r,t,e){return _n(n,(o=r)?o[0].map(function(n,r){return o.map(function(n){return n[r]})}):kn,t,e);var o},n.HOUR=function(n){return(n=s(n))instanceof Error?n:n.getHours()},n.HTML2TEXT=function(n){if(v(n))return n;var r="";return n&&(n instanceof Array?n.forEach(function(n){""!==r&&(r+="\n"),r+=n.replace(/<(?:.|\n)*?>/gm,"")}):r=n.replace(/<(?:.|\n)*?>/gm,"")),r},n.HYPGEOM=Nr,n.HYPGEOMDIST=lt,n.IF=function(n,r,t){return n instanceof Error?n:(null==(r=!(arguments.length>=2)||r)&&(r=0),null==(t=3===arguments.length&&t)&&(t=0),n?r:t)},n.IFERROR=function(n,r){return $(n)?r:n},n.IFNA=function(n,r){return n===jn?r:n},n.IFS=function(){for(var n=0;n<arguments.length/2;n++)if(arguments[2*n])return arguments[2*n+1];return jn},n.IMABS=_,n.IMAGINARY=V,n.IMARGUMENT=G,n.IMCONJUGATE=function(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",0!==t?q(r,-t,e):n},n.IMCOS=k,n.IMCOSH=X,n.IMCOT=function(n){return v(H(n),V(n))?kn:Y(k(n),j(n))},n.IMCSC=function(n){return!0===n||!1===n?kn:v(H(n),V(n))?Hn:Y("1",j(n))},n.IMCSCH=function(n){return!0===n||!1===n?kn:v(H(n),V(n))?Hn:Y("1",B(n))},n.IMDIV=Y,n.IMEXP=function(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);e="i"===e||"j"===e?e:"i";var o=Math.exp(r);return q(o*Math.cos(t),o*Math.sin(t),e)},n.IMLN=function(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",q(Math.log(Math.sqrt(r*r+t*t)),Math.atan(t/r),e)},n.IMLOG10=function(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",q(Math.log(Math.sqrt(r*r+t*t))/Math.log(10),Math.atan(t/r)/Math.log(10),e)},n.IMLOG2=function(n){var r=H(n),t=V(n);if(v(r,t))return kn;var e=n.substring(n.length-1);return e="i"===e||"j"===e?e:"i",q(Math.log(Math.sqrt(r*r+t*t))/Math.log(2),Math.atan(t/r)/Math.log(2),e)},n.IMPOWER=function(n,r){if(v(r=f(r),H(n),V(n)))return kn;var t=n.substring(n.length-1);t="i"===t||"j"===t?t:"i";var e=Math.pow(_(n),r),o=G(n);return q(e*Math.cos(r*o),e*Math.sin(r*o),t)},n.IMPRODUCT=function(){var n=arguments[0];if(!arguments.length)return kn;for(var r=1;r<arguments.length;r++){var t=H(n),e=V(n),o=H(arguments[r]),u=V(arguments[r]);if(v(t,e,o,u))return kn;n=q(t*o-e*u,t*u+e*o)}return n},n.IMREAL=H,n.IMSEC=function(n){return!0===n||!1===n||v(H(n),V(n))?kn:Y("1",k(n))},n.IMSECH=function(n){return v(H(n),V(n))?kn:Y("1",X(n))},n.IMSIN=j,n.IMSINH=B,n.IMSQRT=function(n){if(v(H(n),V(n)))return kn;var r=n.substring(n.length-1);r="i"===r||"j"===r?r:"i";var t=Math.sqrt(_(n)),e=G(n);return q(t*Math.cos(e/2),t*Math.sin(e/2),r)},n.IMSUB=function(n,r){var t=H(n),e=V(n),o=H(r),u=V(r);if(v(t,e,o,u))return kn;var i=n.substring(n.length-1),a=r.substring(r.length-1),f="i";return("j"===i||"j"===a)&&(f="j"),q(t-o,e-u,f)},n.IMSUM=function(){if(!arguments.length)return kn;for(var n=e(arguments),r=n[0],t=1;t<n.length;t++){var o=H(r),u=V(r),i=H(n[t]),a=V(n[t]);if(v(o,u,i,a))return kn;r=q(o+i,u+a)}return r},n.IMTAN=function(n){return!0===n||!1===n||v(H(n),V(n))?kn:Y(j(n),k(n))},n.INDEX=function(n,r,t){var e=g(n,r,t);if(e)return e;if(!Array.isArray(n))return kn;var o=n.length>0&&!Array.isArray(n[0]);return o&&!t?(t=r,r=1):(t=t||1,r=r||1),t<0||r<0?kn:o&&1===r&&t<=n.length?n[t-1]:r<=n.length&&t<=n[r-1].length?n[r-1][t-1]:Xn},n.INFO=function(){throw new Error("INFO is not implemented")},n.INT=function(n){return(n=f(n))instanceof Error?n:Math.floor(n)},n.INTERCEPT=function(n,r){return v(n=l(n),r=l(r))?kn:n.length!==r.length?jn:fn(0,n,r)},n.INTERVAL=function(n){if("number"!=typeof n&&"string"!=typeof n)return kn;n=parseInt(n,10);var r=Math.floor(n/94608e4);n%=94608e4;var t=Math.floor(n/2592e3);n%=2592e3;var e=Math.floor(n/86400);n%=86400;var o=Math.floor(n/3600);n%=3600;var u=Math.floor(n/60),i=n%=60;return"P"+(r=r>0?r+"Y":"")+(t=t>0?t+"M":"")+(e=e>0?e+"D":"")+"T"+(o=o>0?o+"H":"")+(u=u>0?u+"M":"")+(i>0?i+"S":"")},n.INTRATE=function(){throw new Error("INTRATE is not implemented")},n.IPMT=qn,n.IRR=function(n,r){if(r=r||0,v(n=l(e(n)),r=f(r)))return kn;for(var t=function(n,r,t){for(var e=t+1,o=n[0],u=1;u<n.length;u++)o+=n[u]/Math.pow(e,(r[u]-r[0])/365);return o},o=function(n,r,t){for(var e=t+1,o=0,u=1;u<n.length;u++){var i=(r[u]-r[0])/365;o-=i*n[u]/Math.pow(e,i+1)}return o},u=[],i=!1,a=!1,c=0;c<n.length;c++)u[c]=0===c?0:u[c-1]+365,n[c]>0&&(i=!0),n[c]<0&&(a=!0);if(!i||!a)return Hn;var s,h,g,p=r=void 0===r?.1:r,m=!0;do{s=p-(g=t(n,u,p))/o(n,u,p),h=Math.abs(s-p),p=s,m=h>1e-10&&Math.abs(g)>1e-10}while(m);return p},n.ISBINARY=function(n){return/^[01]{1,10}$/.test(n)},n.ISBLANK=function(n){return null===n},n.ISERR=Q,n.ISERROR=$,n.ISEVEN=function(n){return!(1&Math.floor(Math.abs(n)))},n.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},n.ISLOGICAL=Z,n.ISNA=function(n){return n===jn},n.ISNONTEXT=function(n){return"string"!=typeof n},n.ISNUMBER=J,n.ISO=Ur,n.ISODD=function(n){return!!(1&Math.floor(Math.abs(n)))},n.ISOWEEKNUM=y,n.ISPMT=function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t),e=f(e))?kn:e*n*(r/t-1)},n.ISREF=function(){throw new Error("ISREF is not implemented")},n.ISTEXT=nn,n.JOIN=function(n,r){return n.join(r)},n.KURT=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=nr.mean(n),t=n.length,o=0,u=0;u<t;u++)o+=Math.pow(n[u]-r,4);return t*(t+1)/((t-1)*(t-2)*(t-3))*(o/=Math.pow(nr.stdev(n,!0),4))-3*(t-1)*(t-1)/((t-2)*(t-3))},n.LARGE=sn,n.LCM=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r,t,o,u,i=1;void 0!==(o=n.pop());){if(0===o)return 0;for(;o>1;){if(o%2){for(r=3,t=Math.floor(Math.sqrt(o));r<=t&&o%r;r+=2);u=r<=t?r:o}else u=2;for(o/=u,i*=u,r=n.length;r;n[--r]%u==0&&1==(n[r]/=u)&&n.splice(r,1));}}return i},n.LEFT=function(n,r){return g(n,r)||(n=c(n),(r=f(r=void 0===r?1:r))instanceof Error||"string"!=typeof n?kn:n.substring(0,r))},n.LEN=function(n){return 0===arguments.length?Bn:n instanceof Error?n:Array.isArray(n)?kn:c(n).length},n.LINEST=hn,n.LN=function(n){return(n=f(n))instanceof Error?n:0===n?Hn:Math.log(n)},n.LN10=function(){return Math.log(10)},n.LN2=function(){return Math.log(2)},n.LOG=function(n,r){return g(n=f(n),r=f(r))||(0===n||0===r?Hn:Math.log(n)/Math.log(r))},n.LOG10=function(n){return(n=f(n))instanceof Error?n:0===n?Hn:Math.log(n)/Math.log(10)},n.LOG10E=function(){return Math.LOG10E},n.LOG2E=function(){return Math.LOG2E},n.LOGEST=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;for(var t=0;t<n.length;t++)n[t]=Math.log(n[t]);var o=hn(n,r);return o[0]=Math.round(1e6*Math.exp(o[0]))/1e6,o[1]=Math.round(1e6*Math.exp(o[1]))/1e6,o},n.LOGINV=st,n.LOGNORM=wr,n.LOGNORMDIST=ht,n.LOGNORMINV=gt,n.LOOKUP=function(n,r,t){r=e(r),t=e(t);for(var o="number"==typeof n,u=jn,i=0;i<r.length;i++){if(r[i]===n)return t[i];if(o&&r[i]<=n||"string"==typeof r[i]&&r[i].localeCompare(n)<0)u=t[i];else if(o&&r[i]>n)return u}return u},n.LOWER=function(n){return 1!==arguments.length?kn:v(n=c(n))?n:n.toLowerCase()},n.LT=function(n,r){return 2!==arguments.length?jn:(m(n,r)?(n=c(n),r=c(r)):(n=f(n),r=f(r)),g(n,r)||n<r)},n.LTE=function(n,r){return 2!==arguments.length?jn:(m(n,r)?(n=c(n),r=c(r)):(n=f(n),r=f(r)),g(n,r)||n<=r)},n.MATCH=function(n,r,t){if(!n&&!r)return jn;if(2===arguments.length&&(t=1),!(r instanceof Array))return jn;if(r=e(r),-1!==t&&0!==t&&1!==t)return jn;for(var o,u,i=0;i<r.length;i++)if(1===t){if(r[i]===n)return i+1;r[i]<n&&(u?r[i]>u&&(o=i+1,u=r[i]):(o=i+1,u=r[i]))}else if(0===t){if("string"==typeof n){if(n=n.replace(/\?/g,"."),r[i].toLowerCase().match(n.toLowerCase()))return i+1}else if(r[i]===n)return i+1}else if(-1===t){if(r[i]===n)return i+1;r[i]>n&&(u?r[i]<u&&(o=i+1,u=r[i]):(o=i+1,u=r[i]))}return o||jn},n.MAX=gn,n.MAXA=function(){var n=e(arguments),r=g.apply(void 0,n);if(r)return r;var t=d(n);return 0===(t=t.map(function(n){return null==n?0:n})).length?0:Math.max.apply(Math,t)},n.MDURATION=function(){throw new Error("MDURATION is not implemented")},n.MEDIAN=pn,n.MID=function(n,r,t){if(null==r)return kn;if(v(r=f(r),t=f(t))||"string"!=typeof n)return t;var e=r-1,o=e+t;return n.substring(e,o)},n.MIN=vn,n.MINA=function(){var n=e(arguments),r=g.apply(void 0,n);if(r)return r;var t=d(n);return 0===(t=t.map(function(n){return null==n?0:n})).length?0:Math.min.apply(Math,t)},n.MINUS=function(n,r){return 2!==arguments.length?jn:g(n=f(n),r=f(r))||n-r},n.MINUTE=function(n){return(n=s(n))instanceof Error?n:n.getMinutes()},n.MIRR=function(n,r,t){if(v(n=l(e(n)),r=f(r),t=f(t)))return kn;for(var o=n.length,u=[],i=[],a=0;a<o;a++)n[a]<0?u.push(n[a]):i.push(n[a]);var c=-Un(t,i)*Math.pow(1+t,o-1),s=Un(r,u)*(1+r);return Math.pow(c/s,1/(o-1))-1},n.MOD=function(n,r){var t=g(n=f(n),r=f(r));if(t)return t;if(0===r)return Gn;var e=Math.abs(n%r);return e=n<0?r-e:e,r>0?e:-e},n.MODE=Ir,n.MODEMULT=pt,n.MODESNGL=vt,n.MONTH=function(n){return(n=s(n))instanceof Error?n:n.getMonth()+1},n.MROUND=function(n,r){return g(n=f(n),r=f(r))||(n*r==0?0:n*r<0?Hn:Math.round(n/r)*r)},n.MULTINOMIAL=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=0,t=1,o=0;o<n.length;o++)r+=n[o],t*=yn(n[o]);return yn(r)/t},n.MULTIPLY=function(n,r){return 2!==arguments.length?jn:g(n=f(n),r=f(r))||n*r},n.N=function(n){return J(n)?n:n instanceof Date?n.getTime():!0===n?1:!1===n?0:$(n)?n:0},n.NA=function(){return jn},n.NE=function(n,r){return 2!==arguments.length?jn:n instanceof Error?n:r instanceof Error?r:(null===n&&(n=void 0),null===r&&(r=void 0),n!==r)},n.NEGBINOM=yr,n.NEGBINOMDIST=mt,n.NETWORKDAYS=b,n.NETWORKDAYSINTL=dt,n.NOMINAL=function(n,r){return v(n=f(n),r=f(r))?kn:n<=0||r<1?Hn:(r=parseInt(r,10),(Math.pow(n+1,1/r)-1)*r)},n.NORM=br,n.NORMDIST=Et,n.NORMINV=Mt,n.NORMSDIST=Nt,n.NORMSINV=wt,n.NOT=function(n){return"string"==typeof n?kn:n instanceof Error?n:!n},n.NOW=function(){return new Date},n.NPER=function(n,r,t,e,o){if(o=void 0===o?0:o,e=void 0===e?0:e,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o)))return kn;if(0===n)return-(t+e)/r;var u=r*(1+n*o)-e*n,i=t*n+r*(1+n*o);return Math.log(u/i)/Math.log(1+n)},n.NPV=Un,n.NUMBERS=function(){return e(arguments).filter(function(n){return"number"==typeof n})},n.NUMBERVALUE=function(n,r,t){return r=void 0===r?".":r,t=void 0===t?",":t,Number(n.replace(r,".").replace(t,""))},n.OCT2BIN=function(n,r){if(!/^[0-7]{1,10}$/.test(n))return Hn;var t=!(10!==n.length||"7"!==n.substring(0,1)),e=t?parseInt(n,8)-1073741824:parseInt(n,8);if(e<-512||e>511)return Hn;if(t)return"1"+P("0",9-(512+e).toString(2).length)+(512+e).toString(2);var o=e.toString(2);return void 0===r?o:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=o.length?P("0",r-o.length)+o:Hn},n.OCT2DEC=function(n){if(!/^[0-7]{1,10}$/.test(n))return Hn;var r=parseInt(n,8);return r>=536870912?r-1073741824:r},n.OCT2HEX=function(n,r){if(!/^[0-7]{1,10}$/.test(n))return Hn;var t=parseInt(n,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);var e=t.toString(16);return void 0===r?e:isNaN(r)?kn:r<0?Hn:(r=Math.floor(r))>=e.length?P("0",r-e.length)+e:Hn},n.ODD=function(n){if((n=f(n))instanceof Error)return n;var r=Math.ceil(Math.abs(n));return r=1&r?r:r+1,n>=0?r:-r},n.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},n.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},n.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},n.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},n.OR=function(){for(var n=e(arguments),r=kn,t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];void 0!==n[t]&&null!==n[t]&&"string"!=typeof n[t]&&(r===kn&&(r=!1),n[t]&&(r=!0))}return r},n.PDURATION=function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:n<=0?Hn:(Math.log(t)-Math.log(r))/Math.log(1+n)},n.PEARSON=mn,n.PERCENTILE=Tr,n.PERCENTILEEXC=It,n.PERCENTILEINC=yt,n.PERCENTRANK=Sr,n.PERCENTRANKEXC=bt,n.PERCENTRANKINC=Tt,n.PERMUT=function(n,r){return v(n=f(n),r=f(r))?kn:yn(n)/yn(n-r)},n.PERMUTATIONA=function(n,r){return v(n=f(n),r=f(r))?kn:Math.pow(n,r)},n.PHI=function(n){return(n=f(n))instanceof Error?kn:Math.exp(-.5*n*n)/2.5066282746310002},n.PI=function(){return Math.PI},n.PMT=Fn,n.POISSON=Ar,n.POISSONDIST=St,n.POW=function(n,r){return 2!==arguments.length?jn:Tn(n,r)},n.POWER=Tn,n.PPMT=function(n,r,t,e,o,u){return o=o||0,u=u||0,v(n=f(n),t=f(t),e=f(e),o=f(o),u=f(u))?kn:Fn(n,t,e,o,u)-qn(n,r,t,e,o,u)},n.PRICE=function(){throw new Error("PRICE is not implemented")},n.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},n.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},n.PROB=function(n,r,t,o){if(void 0===t)return 0;if(o=void 0===o?t:o,v(n=l(e(n)),r=l(e(r)),t=f(t),o=f(o)))return kn;if(t===o)return n.indexOf(t)>=0?r[n.indexOf(t)]:0;for(var u=n.sort(function(n,r){return n-r}),i=u.length,a=0,c=0;c<i;c++)u[c]>=t&&u[c]<=o&&(a+=r[n.indexOf(u[c])]);return a},n.PRODUCT=Sn,n.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},n.PROPER=function(n){return v(n)?n:isNaN(n)&&"number"==typeof n?kn:(n=c(n)).replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})},n.PV=function(n,r,t,e,o){return e=e||0,o=o||0,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o))?kn:0===n?-t*r-e:((1-Math.pow(1+n,r))/n*t*(1+n*o)-e)/Math.pow(1+n,r)},n.QUARTILE=Dr,n.QUARTILEEXC=At,n.QUARTILEINC=Dt,n.QUOTIENT=function(n,r){return g(n=f(n),r=f(r))||parseInt(n/r,10)},n.RADIANS=function(n){return(n=f(n))instanceof Error?n:n*Math.PI/180},n.RAND=function(){return Math.random()},n.RANDBETWEEN=function(n,r){return g(n=f(n),r=f(r))||n+Math.ceil((r-n+1)*Math.random())-1},n.RANK=Rr,n.RANKAVG=Rt,n.RANKEQ=Ct,n.RATE=function(n,r,t,e,o,u){if(u=void 0===u?.01:u,e=void 0===e?0:e,o=void 0===o?0:o,v(n=f(n),r=f(r),t=f(t),e=f(e),o=f(o),u=f(u)))return kn;var i=1e-10,a=u;o=o?1:0;for(var c=0;c<20;c++){if(a<=-1)return Hn;var l=void 0,s=void 0;if(l=Math.abs(a)<i?t*(1+n*a)+r*(1+a*o)*n+e:t*(s=Math.pow(1+a,n))+r*(1/a+o)*(s-1)+e,Math.abs(l)<i)return a;var h=void 0;if(Math.abs(a)<i)h=t*n+r*o*n;else{s=Math.pow(1+a,n);var g=n*Math.pow(1+a,n-1);h=t*g+r*(1/a+o)*g+r*(-1/(a*a))*(s-1)}a-=l/h}return a},n.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},n.REFERENCE=function(n,r){if(!arguments.length)return Bn;try{for(var t=r.split("."),e=n,o=0;o<t.length;++o){var u=t[o];if("]"===u[u.length-1]){var i=u.indexOf("["),a=u.substring(i+1,u.length-1);e=e[u.substring(0,i)][a]}else e=e[u]}return e}catch(n){}},n.REGEXEXTRACT=function(n,r){if(arguments.length<2)return jn;var t=n.match(new RegExp(r));return t?t[t.length>1?t.length-1:0]:null},n.REGEXMATCH=function(n,r,t){if(arguments.length<2)return jn;var e=n.match(new RegExp(r));return t?e:!!e},n.REGEXREPLACE=function(n,r,t){return arguments.length<3?jn:n.replace(new RegExp(r),t)},n.REPLACE=function(n,r,t,e){return v(r=f(r),t=f(t))||"string"!=typeof n||"string"!=typeof e?kn:n.substr(0,r-1)+e+n.substr(r-1+t)},n.REPT=P,n.RIGHT=function(n,r){return g(n,r)||(n=c(n),(r=f(r=void 0===r?1:r))instanceof Error?r:n.substring(n.length-r))},n.ROMAN=function(n){if((n=f(n))instanceof Error)return n;for(var r=String(n).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],e="",o=3;o--;)e=(t[+r.pop()+10*o]||"")+e;return new Array(+r.join("")+1).join("M")+e},n.ROUND=An,n.ROUNDDOWN=function(n,r){return g(n=f(n),r=f(r))||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,r))/Math.pow(10,r)},n.ROUNDUP=function(n,r){return g(n=f(n),r=f(r))||(n>0?1:-1)*Math.ceil(Math.abs(n)*Math.pow(10,r))/Math.pow(10,r)},n.ROW=function(n,r){return 2!==arguments.length?jn:r<0?Hn:n instanceof Array&&"number"==typeof r?0!==n.length?nr.row(n,r):void 0:kn},n.ROWS=function(n){return 1!==arguments.length?jn:n instanceof Array?0===n.length?0:nr.rows(n):kn},n.RRI=function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:0===n||0===r?Hn:Math.pow(t/r,1/n)-1},n.RSQ=function(n,r){return v(n=l(e(n)),r=l(e(r)))?kn:Math.pow(mn(n,r),2)},n.SEARCH=function(n,r,t){var e;return"string"!=typeof n||"string"!=typeof r?kn:(t=void 0===t?0:t,0===(e=r.toLowerCase().indexOf(n.toLowerCase(),t-1)+1)?kn:e)},n.SEC=function(n){return(n=f(n))instanceof Error?n:1/Math.cos(n)},n.SECH=function(n){return(n=f(n))instanceof Error?n:2/(Math.exp(n)+Math.exp(-n))},n.SECOND=function(n){return(n=s(n))instanceof Error?n:n.getSeconds()},n.SERIESSUM=function(n,r,t,e){if(v(n=f(n),r=f(r),t=f(t),e=l(e)))return kn;for(var o=e[0]*Math.pow(n,r),u=1;u<e.length;u++)o+=e[u]*Math.pow(n,r+u*t);return o},n.SHEET=function(){throw new Error("SHEET is not implemented")},n.SHEETS=function(){throw new Error("SHEETS is not implemented")},n.SIGN=function(n){return(n=f(n))instanceof Error?n:n<0?-1:0===n?0:1},n.SIN=function(n){return(n=f(n))instanceof Error?n:Math.sin(n)},n.SINH=function(n){return(n=f(n))instanceof Error?n:(Math.exp(n)-Math.exp(-n))/2},n.SKEW=dn,n.SKEWP=xt,n.SLN=function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:0===t?Hn:(n-r)/t},n.SLOPE=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;for(var t=nr.mean(r),o=nr.mean(n),u=r.length,i=0,a=0,f=0;f<u;f++)i+=(r[f]-t)*(n[f]-o),a+=Math.pow(r[f]-t,2);return i/a},n.SMALL=En,n.SPLIT=function(n,r){return n.split(r)},n.SQRT=function(n){return(n=f(n))instanceof Error?n:n<0?Hn:Math.sqrt(n)},n.SQRT1_2=function(){return 1/Math.sqrt(2)},n.SQRT2=function(){return Math.sqrt(2)},n.SQRTPI=function(n){return(n=f(n))instanceof Error?n:Math.sqrt(n*Math.PI)},n.STANDARDIZE=function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:(n-r)/t},n.STDEV=Cr,n.STDEVA=function(){var n=Mn.apply(this,arguments);return Math.sqrt(n)},n.STDEVP=Ot,n.STDEVPA=function(){var n=Nn.apply(this,arguments),r=Math.sqrt(n);return isNaN(r)&&(r=Hn),r},n.STDEVS=Pt,n.STEYX=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;for(var t=nr.mean(r),o=nr.mean(n),u=r.length,i=0,a=0,f=0,c=0;c<u;c++)i+=Math.pow(n[c]-o,2),a+=(r[c]-t)*(n[c]-o),f+=Math.pow(r[c]-t,2);return Math.sqrt((i-a*a/f)/(u-2))},n.SUBSTITUTE=function(n,r,t,e){if(arguments.length<3)return jn;if(n&&r){if(void 0===e)return n.split(r).join(t);if(e=Math.floor(Number(e)),Number.isNaN(e)||e<=0)return kn;for(var o=0,u=0;o>-1&&n.indexOf(r,o)>-1;)if(u++,(o=n.indexOf(r,o+1))>-1&&u===e)return n.substring(0,o)+t+n.substring(o+r.length);return n}return n},n.SUBTOTAL=function(n,r){if((n=f(n))instanceof Error)return n;switch(n){case 1:case 101:return tn(r);case 2:case 102:return on(r);case 3:case 103:return un(r);case 4:case 104:return gn(r);case 5:case 105:return vn(r);case 6:case 106:return Sn(r);case 7:case 107:return Cr.S(r);case 8:case 108:return Cr.P(r);case 9:case 109:return Dn(r);case 10:case 110:return Or.S(r);case 11:case 111:return Or.P(r)}},n.SUM=Dn,n.SUMIF=function(n,r,t){if(n=e(n),t=t?e(t):n,n instanceof Error)return n;if(null==r||r instanceof Error)return 0;for(var o=0,u="*"===r,i=u?null:W(r+""),a=0;a<n.length;a++){var f=n[a],c=t[a];if(u)o+=f;else{var l=[z(f,cr)].concat(i);o+=lr(l)?c:0}}return o},n.SUMIFS=function(){var n=o(arguments),r=l(e(n.shift()));if(r instanceof Error)return r;for(var t=n,u=t.length/2,i=0;i<u;i++)t[2*i]=e(t[2*i]);for(var a=0,f=0;f<r.length;f++){for(var c=!1,s=0;s<u;s++){var h=t[2*s][f],g=t[2*s+1],p=!1;if(void 0===g||"*"===g)p=!0;else{var v=W(g+""),m=[z(h,cr)].concat(v);p=lr(m)}if(!p){c=!1;break}c=!0}c&&(a+=r[f])}return a},n.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return kn;for(var n,r,t,e,o=arguments.length+1,u=0,i=0;i<arguments[0].length;i++)if(arguments[0][i]instanceof Array)for(var a=0;a<arguments[0][i].length;a++){for(n=1,r=1;r<o;r++){var c=arguments[r-1][i][a];if(c instanceof Error)return c;if((e=f(c))instanceof Error)return e;n*=e}u+=n}else{for(n=1,r=1;r<o;r++){var l=arguments[r-1][i];if(l instanceof Error)return l;if((t=f(l))instanceof Error)return t;n*=t}u+=n}return u},n.SUMSQ=function(){var n=l(e(arguments));if(n instanceof Error)return n;for(var r=0,t=n.length,o=0;o<t;o++)r+=J(n[o])?n[o]*n[o]:0;return r},n.SUMX2MY2=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;for(var t=0,o=0;o<n.length;o++)t+=n[o]*n[o]-r[o]*r[o];return t},n.SUMX2PY2=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;var t=0;n=l(e(n)),r=l(e(r));for(var o=0;o<n.length;o++)t+=n[o]*n[o]+r[o]*r[o];return t},n.SUMXMY2=function(n,r){if(v(n=l(e(n)),r=l(e(r))))return kn;var t=0;n=e(n),r=e(r);for(var o=0;o<n.length;o++)t+=Math.pow(n[o]-r[o],2);return t},n.SWITCH=function(){var n;if(arguments.length>0){
var r=arguments[0],t=arguments.length-1,e=Math.floor(t/2),o=!1,u=t%2!=0,i=t%2==0?null:arguments[arguments.length-1];if(e)for(var a=0;a<e;a++)if(r===arguments[2*a+1]){n=arguments[2*a+2],o=!0;break}o||(n=u?i:jn)}else n=kn;return n},n.SYD=function(n,r,t,e){return v(n=f(n),r=f(r),t=f(t),e=f(e))?kn:0===t||e<1||e>t?Hn:(n-r)*(t-(e=parseInt(e,10))+1)*2/(t*(t+1))},n.T=function(n){return n instanceof Error||"string"==typeof n?n:""},n.TAN=function(n){return(n=f(n))instanceof Error?n:Math.tan(n)},n.TANH=function(n){if((n=f(n))instanceof Error)return n;var r=Math.exp(2*n);return(r-1)/(r+1)},n.TBILLEQ=function(n,r,t){return v(n=s(n),r=s(r),t=f(t))?kn:t<=0||n>r||r-n>31536e6?Hn:365*t/(360-t*I(n,r,!1))},n.TBILLPRICE=function(n,r,t){return v(n=s(n),r=s(r),t=f(t))?kn:t<=0||n>r||r-n>31536e6?Hn:100*(1-t*I(n,r,!1)/360)},n.TBILLYIELD=function(n,r,t){return v(n=s(n),r=s(r),t=f(t))?kn:t<=0||n>r||r-n>31536e6?Hn:360*(100-t)/(t*I(n,r,!1))},n.TDIST=Lt,n.TDISTRT=qt,n.TEXT=function(){throw new Error("TEXT is not implemented")},n.TEXTJOIN=function(n,r){for(var t,o=arguments.length,u=new Array(o>2?o-2:0),i=2;i<o;i++)u[i-2]=arguments[i];if("boolean"!=typeof r&&(r=a(r)),arguments.length<3)return jn;n=null!==(t=n)&&void 0!==t?t:"";var f=e(u),c=r?f.filter(function(n){return n}):f;if(Array.isArray(n)){n=e(n);for(var l=c.map(function(n){return[n]}),s=0,h=0;h<l.length-1;h++)l[h].push(n[s]),++s===n.length&&(s=0);return(c=e(l)).join("")}return c.join(n)},n.TIME=function(n,r,t){return v(n=f(n),r=f(r),t=f(t))?kn:n<0||r<0||t<0?Hn:(3600*n+60*r+t)/86400},n.TIMEVALUE=function(n){return(n=s(n))instanceof Error?n:(3600*n.getHours()+60*n.getMinutes()+n.getSeconds())/86400},n.TINV=Ut,n.TODAY=function(){return N(new Date)},n.TRANSPOSE=function(n){return n?nr.transpose(n):jn},n.TREND=function(n,r,t){if(v(n=l(e(n)),r=l(e(r)),t=l(e(t))))return kn;var o=hn(n,r),u=o[0],i=o[1],a=[];return t.forEach(function(n){a.push(u*n+i)}),a},n.TRIM=function(n){return(n=c(n))instanceof Error?n:n.replace(/\s+/g," ").trim()},n.TRIMMEAN=function(n,r){if(v(n=l(e(n)),r=f(r)))return kn;var t,o,u=bn(n.length*r,2)/2;return nr.mean((o=(o=u)||1,(t=E(n.sort(function(n,r){return n-r}),u))&&"function"==typeof t.slice?t.slice(0,t.length-o):t))},n.TRUE=function(){return!0},n.TRUNC=function(n,r){return g(n=f(n),r=f(r))||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,r))/Math.pow(10,r)},n.TTEST=Ft,n.TYPE=function(n){return J(n)?1:nn(n)?2:Z(n)?4:$(n)?16:Array.isArray(n)?64:void 0},n.UNICHAR=tr,n.UNICODE=er,n.UNIQUE=rn,n.UPPER=function(n){return(n=c(n))instanceof Error?n:n.toUpperCase()},n.VALUE=function(n){var r=g(n);if(r)return r;if("string"!=typeof n)return kn;var t=/(%)$/.test(n)||/^(%)/.test(n);if(""===(n=(n=(n=n.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return kn;var e=Number(n);return isNaN(e)?kn:(e=e||0,t&&(e*=.01),e)},n.VAR=Or,n.VARA=Mn,n.VARP=_t,n.VARPA=Nn,n.VARS=Vt,n.VDB=function(){throw new Error("VDB is not implemented")},n.VLOOKUP=_n,n.WEEKDAY=function(n,r){if((n=s(n))instanceof Error)return n;void 0===r&&(r=1);var t=n.getDay();return Qn[r][t]},n.WEEKNUM=function(n,r){if((n=s(n))instanceof Error)return n;if(void 0===r&&(r=1),21===r)return y(n);var t=Wn[r],e=new Date(n.getFullYear(),0,1),o=e.getDay()<t?1:0;return e-=24*Math.abs(e.getDay()-t)*60*60*1e3,Math.floor((n-e)/864e5/7+1)+o},n.WEIBULL=Pr,n.WEIBULLDIST=Gt,n.WORKDAY=T,n.WORKDAYINTL=kt,n.XIRR=function(n,r,t){if(v(n=l(e(n)),r=h(e(r)),t=f(t)))return kn;for(var o=function(n,r,t){for(var e=t+1,o=n[0],u=1;u<n.length;u++)o+=n[u]/Math.pow(e,w(r[u],r[0])/365);return o},u=function(n,r,t){for(var e=t+1,o=0,u=1;u<n.length;u++){var i=w(r[u],r[0])/365;o-=i*n[u]/Math.pow(e,i+1)}return o},i=!1,a=!1,c=0;c<n.length;c++)n[c]>0&&(i=!0),n[c]<0&&(a=!0);if(!i||!a)return Hn;var s,g,p,m=t=t||.1,d=!0;do{s=m-(p=o(n,r,m))/u(n,r,m),g=Math.abs(s-m),m=s,d=g>1e-10&&Math.abs(p)>1e-10}while(d);return m},n.XNPV=function(n,r,t){if(v(n=f(n),r=l(e(r)),t=h(e(t))))return kn;for(var o=0,u=0;u<r.length;u++)o+=r[u]/Math.pow(1+n,w(t[u],t[0])/365);return o},n.XOR=function(){for(var n=e(arguments),r=kn,t=0;t<n.length;t++){if(n[t]instanceof Error)return n[t];void 0!==n[t]&&null!==n[t]&&"string"!=typeof n[t]&&(r===kn&&(r=0),n[t]&&r++)}return r===kn?r:!!(1&Math.floor(Math.abs(r)))},n.YEAR=function(n){return(n=s(n))instanceof Error?n:n.getFullYear()},n.YEARFRAC=D,n.YIELD=function(){throw new Error("YIELD is not implemented")},n.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},n.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},n.Z=Lr,n.ZTEST=Xt,Object.defineProperty(n,"__esModule",{value:!0})});
// dr_codemirror.js.coffee
(function(){var r,e;decko.editors.add(".codemirror-editor-textarea",function(){return e($(this))},function(){return r($(this))}),e=function(r){var e;return e=CodeMirror.fromTextArea(r[0],{mode:"coffeescript",theme:"midnight"}),r.data("codeMirror",e),setTimeout(function(){return e.refresh()},200)},r=function(r){return r.data("codeMirror").getValue()}}).call(this);
// tree.js.coffee
(function(){var t,e;$(function(){return $("body").on("shown.bs.collapse",".tree-collapse",function(e){return t($(e.target))})}),decko.slot.ready(function(){}),t=function(t){return t.find(".card-slot-stub").each(function(){var t;if(t=$(this),e(t))return t.slotReload(t.data("stubUrl")),t.removeClass("card-slot-stub")})},e=function(t){var e;return(e=t.closest(".tree-item")).children(".tree-header").is(":visible")||e.parent().hasClass("_tree-top")}}).call(this);