// decko_vega.js.coffee
(function(){var t,e,n,i,r,s;$(document).ready(function(){return $("body").on("click","._filter-bindings",function(){var t,e;return t="with-bindings",(e=$(this).closest(".vis")).hasClass(t)?e.removeClass(t):e.addClass(t),$(this).closest("details").removeAttr("open")})}),decko.slot.ready(function(t){var e,n,r,s,a;for(s=[],e=0,n=(r=t.find(".vis._load-vis")).length;e<n;e++)a=r[e],s.push(i($(a)));return s}),i=function(t){return t.removeClass("_load-vis"),$.ajax({url:t.data("url"),visID:t.attr("id"),dataType:"json",type:"GET",success:function(t){return n(t,this.visID)}})},n=function(n,i){var r;return r=$("#"+i),vegaEmbed(r[0],n).then(function(n){return e(n.view,r),t()})},e=function(t,e){return t.addEventListener("click",function(t,n){var i;if(e.closest("._filtered-content").exists())return(i=n.datum).filter?s(e,i.filter):i.details?r(i.details):void 0})},s=function(t,e){return $.extend(decko.filter.query(t).filter,e),decko.filter.refilter(t)},r=function(t){return $('.bar[data-card-link-name="'+t+'"]').trigger("click")},t=function(){return $(".vega-actions").append("<a class='_filter-bindings'>Tweak</a>")}}).call(this);