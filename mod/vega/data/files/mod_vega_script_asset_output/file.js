// decko_vega.js.coffee
(function(){var t,e,n,r,i,s;$(document).ready(function(){return $("body").on("click","._filter-bindings",function(){var t,e;return t="with-bindings",(e=$(this).closest(".vis")).hasClass(t)?e.removeClass(t):e.addClass(t),$(this).closest("details").removeAttr("open")})}),decko.slot.ready(function(t){var e,n,i,s,a;for(s=[],e=0,n=(i=t.find(".vis._load-vis")).length;e<n;e++)a=i[e],s.push(r($(a)));return s}),r=function(t){return t.removeClass("_load-vis"),$.ajax({url:t.data("url"),visID:t.attr("id"),dataType:"json",type:"GET",success:function(t){return n(t,this.visID)}})},n=function(n,r){var i;return i=$("#"+r),vegaEmbed(i[0],n).then(function(n){return e(n.view,i),t()})},e=function(t,e){return t.addEventListener("click",function(t,n){var r;if(e.closest("._filtered-content").exists())return(r=n.datum).filter?s(e,r.filter):r.details?i(r.details):void 0})},s=function(t,e){var n;return n=t.closest("form"),e=$.extend(n.data("filter"),e),decko.filter.refilter(n,{filter:e})},i=function(t){return $('.bar[data-card-link-name="'+t+'"]').trigger("click")},t=function(){return $(".vega-actions").append("<a class='_filter-bindings'>Tweak</a>")}}).call(this);