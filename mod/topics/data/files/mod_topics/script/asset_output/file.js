// topic_selector.js.coffee
(function(){var t,e,n,i,r,o,c,a,d,u,l,f;o="bg-topic",n="._topic-tree-input",t="._topic-tree-filter",e="._topic-tree-hidden",$.extend(decko.editors.content,((i={})[""+n]=function(){return decko.pointerContent(d(this))},i)),$.extend(decko.editors.init,((r={})[""+n]=function(){return a(this,this.contentField().val().split("\n"),!0)},r)),decko.slot.ready(function(n){var i,r;if((i=n.find(t)).length>0)return r=i.find(e+" input").map(function(){return $(this).val()}),a(i,r,!1)}),$(function(){return $("body").on("click",n+" .tree-leaf",function(){return u($(this),!0)}),$("body").on("click",t+" .tree-leaf",function(){var t;return t=$(this),u(t,!1),l(t),t.closest("form").submit()})}),l=function(n){var i,r,o;return i=n.closest(t),(r=i.find(e)).find("input").remove(),o=r.data("hidden-name"),$.each(d(i),function(t,e){return r.append("<input type='hidden' name='"+o+"' value='"+e+"'>")})},d=function(t){return $(t).find(".card-title."+o).map(function(){return f(this)})},u=function(t,e){if(t.find("> .card-title, > h2 .card-title").toggleClass(o),e)return c(t)},c=function(t){var e,n;if((n=t.closest(".tree-item")).length)return e=n.find(".tree-body ."+o).length>0,n.find("> .tree-header .card-title").toggleClass(o,e),c(n.parent())},f=function(t){return $(t).closest("[data-treeval]").data("treeval")},a=function(t,e,n){var i,r,o,c,a;for(c=[],i=0,r=e.length;i<r;i++)a=e[i],o=t.find("[data-treeval='"+a+"']"),u(o,n),c.push(o.parents(".tree-collapse").collapse("show"));return c}}).call(this);